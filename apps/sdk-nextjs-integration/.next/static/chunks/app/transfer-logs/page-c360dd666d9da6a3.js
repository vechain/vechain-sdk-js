(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[640],{1305:(e,t,a)=>{Promise.resolve().then(a.bind(a,6544))},6544:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>tW});var n,i=a(4568),o=a(6607),r=a(8501),s=a(2325),l=a(1298),c=a(4009),d=a(1475),u=a(5860),h=a(9272),g=a(6245),p=a(3897),m=a(4338),y=Object.defineProperty;((e,t)=>{for(var a in t)y(e,a,{get:t[a],enumerable:!0})})({},{AccountDetail:()=>k,AccountsModule:()=>K,BUILT_IN_CONTRACTS:()=>I,BlocksModule:()=>z,CHAIN_ID:()=>eC,CHAIN_TAG:()=>ex,Contract:()=>ee,ContractFactory:()=>et,ContractsModule:()=>ea,DebugModule:()=>en,DefaultBlockToRevision:()=>eI,DelegationHandler:()=>eg,ERROR_SELECTOR:()=>M,ForkDetector:()=>ey,GasModule:()=>ei,HTTPS_REGEX:()=>x,HTTP_REGEX:()=>C,HardhatVeChainProvider:()=>tL,HttpMethod:()=>v,JSONRPCEthersProvider:()=>eP,LogsModule:()=>eo,MAINNET_URL:()=>A,NODE_HEALTHCHECK_TOLERANCE_IN_SECONDS:()=>S,NodesModule:()=>es,PANIC_SELECTOR:()=>E,POLLING_INTERVAL:()=>eB,Poll:()=>U,ProviderInternalBaseWallet:()=>eT,ProviderInternalHDWallet:()=>e_,RPCMethodsMap:()=>tF,RPC_DOCUMENTATION_URL:()=>N,RPC_METHODS:()=>B,SimpleHttpClient:()=>_,TESTNET_URL:()=>R,THOR_SOLO_URL:()=>G,ThorClient:()=>ev,TransactionsModule:()=>eu,VeChainAbstractSigner:()=>ef,VeChainPrivateKeySigner:()=>ew,VeChainProvider:()=>tD,blocksFormatter:()=>eN,buildQuery:()=>F,chainTagToChainId:()=>eS,debugFormatter:()=>eD,debugTraceBlockByHash:()=>eZ,debugTraceBlockByNumber:()=>e$,debugTraceCall:()=>e0,debugTraceTransaction:()=>eJ,engineGetPayloadBodiesByHashV1:()=>e1,engineGetPayloadBodiesByRangeV1:()=>e2,ethAccounts:()=>e3,ethBlockNumber:()=>e4,ethCall:()=>e6,ethChainId:()=>eW,ethEstimateGas:()=>e9,ethFeeHistory:()=>e5,ethGasPrice:()=>e8,ethGetBalance:()=>e7,ethGetBlockByHash:()=>eY,ethGetBlockByNumber:()=>eX,ethGetBlockReceipts:()=>te,ethGetBlockTransactionCountByHash:()=>tt,ethGetBlockTransactionCountByNumber:()=>ta,ethGetCode:()=>tn,ethGetFilterChanges:()=>ti,ethGetFilterLogs:()=>to,ethGetLogs:()=>tr,ethGetStorageAt:()=>ts,ethGetTransactionByBlockHashAndIndex:()=>tc,ethGetTransactionByBlockNumberAndIndex:()=>td,ethGetTransactionByHash:()=>tl,ethGetTransactionCount:()=>tu,ethGetTransactionReceipt:()=>eQ,ethGetUncleByBlockHashAndIndex:()=>th,ethGetUncleByBlockNumberAndIndex:()=>tg,ethGetUncleCountByBlockHash:()=>tp,ethGetUncleCountByBlockNumber:()=>tm,ethMaxPriorityFeePerGas:()=>ty,ethRequestAccounts:()=>tv,ethSendRawTransaction:()=>tf,ethSendTransaction:()=>tw,ethSignTransaction:()=>tb,ethSignTypedDataV4:()=>tT,ethSubscribe:()=>t_,ethSyncing:()=>tB,ethUnsubscribe:()=>tk,evmMine:()=>tI,formatToLogsRPC:()=>eL,formatToRPCStandard:()=>eF,getCachedChainId:()=>eK,getCachedChainTag:()=>ez,getCriteriaSetForInput:()=>eO,getNumberOfLogsAheadOfTransactionIntoBlockExpanded:()=>eE,getTransactionIndexIntoBlock:()=>eM,isTraceEnabled:()=>f,logError:()=>T,logRequest:()=>w,logResponse:()=>b,netListening:()=>tC,netPeerCount:()=>tx,netVersion:()=>tS,sanitizeWebsocketBaseURL:()=>H,signerUtils:()=>P,subscriptions:()=>j,thorest:()=>V,toQueryString:()=>O,transactionsFormatter:()=>eG,txPoolContent:()=>tM,txPoolContentFrom:()=>tE,txPoolInspect:()=>tA,txPoolStatus:()=>tR,vnsUtils:()=>W,web3ClientVersion:()=>tG,web3Sha3:()=>tN});var v=(e=>(e.GET="GET",e.POST="POST",e))(v||{}),f=()=>{var e,t;let a=null==m?void 0:null===(t=m.env)||void 0===t?void 0:null===(e=t.SDK_TRACE)||void 0===e?void 0:e.toLowerCase();return"true"===a||"1"===a},w=(e,t,a,n)=>{if(!f())return Date.now();let i=Date.now();if(console.log("\n⚡ [TRACE] HTTP Request (".concat(new Date(i).toISOString(),")")),console.log("➡️ ".concat(JSON.stringify({category:"HTTP Request",method:e,url:t,requestHeaders:a,requestBody:n,timestamp:i},null,2))),null!=a&&Object.keys(a).length>0&&(console.log("\uD83D\uDCCB Headers:"),Object.entries(a).forEach(e=>{let[t,a]=e;console.log("   ".concat(t,": ").concat(a))})),void 0!==n){console.log("\uD83D\uDCE6 Body:");try{console.log("string"==typeof n?n:JSON.stringify(n,null,2))}catch(e){console.log("[Complex body object]")}}return i},b=(e,t,a,n)=>{if(!f())return;let i=Date.now(),o=i-e;if(console.log("\n⚡ [TRACE] HTTP Response (".concat(new Date(i).toISOString(),")")),console.log("➡️ ".concat(JSON.stringify({category:"HTTP Response",url:t,responseHeaders:a,responseBody:n,timestamp:i,duration:o},null,2))),console.log("⬅️ ".concat(t," (").concat(o,"ms)")),null!=a&&Object.keys(a).length>0&&(console.log("\uD83D\uDCCB Headers:"),Object.entries(a).forEach(e=>{let[t,a]=e;console.log("   ".concat(t,": ").concat(a))})),null!==n){console.log("\uD83D\uDCE6 Body:");try{console.log("string"==typeof n?n:JSON.stringify(n,null,2))}catch(e){console.log("[Complex response body]")}}},T=(e,t,a,n)=>{if(!f())return;let i=Date.now(),o=i-e;console.log("\n⚡ [TRACE] HTTP Error (".concat(new Date(i).toISOString(),")")),console.log("➡️ ".concat(JSON.stringify({category:"HTTP Error",method:a,url:t,error:n,timestamp:i,duration:o},null,2))),console.log("❌ ".concat(a," ").concat(t," (").concat(o,"ms)")),console.log("⛔ Error:"),null!=n&&n instanceof Error?(console.log("   ".concat(n.name,": ").concat(n.message)),null!=n.stack&&console.log("   Stack: ".concat(n.stack)),"cause"in n&&null!=n.cause&&(console.log("   Cause:"),console.log(n.cause))):console.log(n)},_=((n=class e{async get(e,t){return await this.http("GET",e,t)}isValidUrl(e){try{return new URL(e),!0}catch(e){return!1}}async http(e,t,a){let n=new AbortController,i=setTimeout(()=>{n.abort()},this.timeout),o,s=Date.now(),l={};try{let i;t.startsWith("/")&&(t=t.slice(1));let r=this.baseURL;r.endsWith("/")||(r+="/"),o=/^https?:\/\//.exec(t)?new URL(t):new URL(t,r),(null==a?void 0:a.query)&&void 0!==o&&Object.entries(a.query).forEach(e=>{let[t,a]=e;o.searchParams.append(t,String(a))}),(null==a?void 0:a.query)!==void 0&&(null==a?void 0:a.query)!=null&&void 0!==o&&Object.entries(a.query).forEach(e=>{let[t,a]=e;o.searchParams.append(t,String(a))});let h=new Headers(this.headers);(null==a?void 0:a.headers)!==void 0&&(null==a?void 0:a.headers)!=null&&Object.entries(a.headers).forEach(e=>{let[t,a]=e;h.append(t,String(a))}),l=Object.fromEntries(h.entries()),s=w(e,o.toString(),l,"GET"!==e?null==a?void 0:a.body:void 0);let g=await fetch(o.toString(),{method:e,headers:h,body:"GET"!==e?(null==a?void 0:a.rawBody)!==void 0?a.rawBody:JSON.stringify(null==a?void 0:a.body):void 0,signal:n.signal}),p=Object.fromEntries(g.headers.entries());if(g.ok){(null==a?void 0:a.validateResponseHeader)!=null&&null!=p&&a.validateResponseHeader(p);let e=await g.json();return b(s,o.toString(),p,e),e}try{i=await g.clone().text()}catch(e){i=void 0}let m="HTTP ".concat(g.status," ").concat(g.statusText);if(null==i?void 0:i.trim()){let e=i.trim();if(!e.includes("<!DOCTYPE html>")){if(e.startsWith("{")||e.startsWith("["))try{let t=JSON.parse(e);if(t.error&&"object"==typeof t.error&&null!==t.error){var c,d,u;let e=t.error,a=null!==(c=e.code)&&void 0!==c?c:"",n=null!==(u=null!==(d=e.message)&&void 0!==d?d:e.msg)&&void 0!==u?u:"";a&&(m+=" [".concat(a,"]")),n&&(m+=" - ".concat(n));let i=e.data;i&&"string"==typeof i&&i.trim()&&(m+=" (".concat(i,")"))}}catch(e){}else if(!e.includes("<!DOCTYPE html>")){let t=e.split("\n")[0].trim();if(t.includes(": ")){let[e,a]=t.split(": ",2);e&&a?m+=" - ".concat(e,": ").concat(a):m+=" - ".concat(t)}else t.includes(" - "),m+=" - ".concat(t)}}}throw Error(m,{cause:g})}catch(a){if(o){let t=o.toString();throw T(s,t,e,a),a instanceof TypeError?new r.z3("HttpClient.http()",a.message,{method:e,url:t,networkErrorType:"TypeError"},a):new r.Jy("HttpClient.http()",a.message,{method:e,url:t},a)}{let n=this.isValidUrl(this.baseURL)?new URL(t,this.baseURL).toString():t;throw new r.gY("HttpClient.http()",a.message,{method:e,url:n},a)}}finally{clearTimeout(i)}}async post(e,t){return await this.http("POST",e,t)}constructor(t,a=new Headers,n=e.DEFAULT_TIMEOUT){this.baseURL=t,this.timeout=n,this.headers=a}}).DEFAULT_TIMEOUT=1e4,n),P={transactionBodyToTransactionRequestInput:function(e,t){var a,n,i;if(void 0!==e.nonce&&("string"==typeof e.nonce?parseInt(e.nonce,10):e.nonce)<0)throw Error("Transaction nonce must be a positive number");return{from:t,chainTag:e.chainTag,blockRef:e.blockRef,expiration:e.expiration,clauses:e.clauses,gasPriceCoef:e.gasPriceCoef,gas:e.gas,dependsOn:null!==(a=e.dependsOn)&&void 0!==a?a:void 0,nonce:e.nonce,reserved:e.reserved,maxPriorityFeePerGas:null!==(n=e.maxPriorityFeePerGas)&&void 0!==n?n:void 0,maxFeePerGas:null!==(i=e.maxFeePerGas)&&void 0!==i?i:void 0}}},B=(e=>(e.eth_blockNumber="eth_blockNumber",e.eth_chainId="eth_chainId",e.eth_getBalance="eth_getBalance",e.eth_getCode="eth_getCode",e.eth_getStorageAt="eth_getStorageAt",e.eth_estimateGas="eth_estimateGas",e.eth_call="eth_call",e.eth_sendRawTransaction="eth_sendRawTransaction",e.eth_getLogs="eth_getLogs",e.eth_getBlockByHash="eth_getBlockByHash",e.eth_getBlockByNumber="eth_getBlockByNumber",e.eth_accounts="eth_accounts",e.eth_requestAccounts="eth_requestAccounts",e.eth_gasPrice="eth_gasPrice",e.eth_getTransactionByHash="eth_getTransactionByHash",e.eth_getTransactionCount="eth_getTransactionCount",e.eth_getTransactionReceipt="eth_getTransactionReceipt",e.eth_getTransactionByBlockNumberAndIndex="eth_getTransactionByBlockNumberAndIndex",e.eth_getTransactionByBlockHashAndIndex="eth_getTransactionByBlockHashAndIndex",e.eth_getBlockTransactionCountByHash="eth_getBlockTransactionCountByHash",e.eth_getBlockTransactionCountByNumber="eth_getBlockTransactionCountByNumber",e.eth_sendTransaction="eth_sendTransaction",e.eth_syncing="eth_syncing",e.net_version="net_version",e.web3_clientVersion="web3_clientVersion",e.eth_subscribe="eth_subscribe",e.eth_unsubscribe="eth_unsubscribe",e.debug_traceTransaction="debug_traceTransaction",e.debug_traceCall="debug_traceCall",e.evm_mine="evm_mine",e.evm_increaseTime="evm_increaseTime",e.web3_sha3="web3_sha3",e.net_peerCount="net_peerCount",e.net_listening="net_listening",e.eth_getUncleByBlockNumberAndIndex="eth_getUncleByBlockNumberAndIndex",e.eth_getUncleByBlockHashAndIndex="eth_getUncleByBlockHashAndIndex",e.txpool_inspect="txpool_inspect",e.txpool_contentFrom="txpool_contentFrom",e.txpool_content="txpool_content",e.txpool_status="txpool_status",e.eth_signTransaction="eth_signTransaction",e.debug_traceBlockByHash="debug_traceBlockByHash",e.debug_traceBlockByNumber="debug_traceBlockByNumber",e.eth_getUncleCountByBlockHash="eth_getUncleCountByBlockHash",e.eth_getUncleCountByBlockNumber="eth_getUncleCountByBlockNumber",e.eth_signTypedData_v4="eth_signTypedData_v4",e.eth_getBlockReceipts="eth_getBlockReceipts",e.eth_coinbase="eth_coinbase",e.eth_feeHistory="eth_feeHistory",e.eth_getWork="eth_getWork",e.eth_mining="eth_mining",e.eth_hashrate="eth_hashrate",e.eth_protocolVersion="eth_protocolVersion",e.eth_sign="eth_sign",e.eth_submitWork="eth_submitWork",e.parity_nextNonce="parity_nextNonce",e.eth_newFilter="eth_newFilter",e.eth_newBlockFilter="eth_newBlockFilter",e.eth_newPendingTransactionFilter="eth_newPendingTransactionFilter",e.eth_getFilterLogs="eth_getFilterLogs",e.eth_getFilterChanges="eth_getFilterChanges",e.eth_uninstallFilter="eth_uninstallFilter",e.debug_getBadBlocks="debug_getBadBlocks",e.debug_getRawBlock="debug_getRawBlock",e.debug_getRawHeader="debug_getRawHeader",e.debug_getRawReceipts="debug_getRawReceipts",e.debug_getRawTransaction="debug_getRawTransaction",e.engine_exchangeCapabilities="engine_exchangeCapabilities",e.engine_exchangeTransitionConfigurationV1="engine_exchangeTransitionConfigurationV1",e.engine_forkchoiceUpdatedV1="engine_forkchoiceUpdatedV1",e.engine_forkchoiceUpdatedV2="engine_forkchoiceUpdatedV2",e.engine_forkchoiceUpdatedV3="engine_forkchoiceUpdatedV3",e.engine_getPayloadBodiesByHashV1="engine_getPayloadBodiesByHashV1",e.engine_getPayloadBodiesByRangeV1="engine_getPayloadBodiesByRangeV1",e.engine_getPayloadV1="engine_getPayloadV1",e.engine_getPayloadV2="engine_getPayloadV2",e.engine_getPayloadV3="engine_getPayloadV3",e.engine_newPayloadV1="engine_newPayloadV1",e.engine_newPayloadV2="engine_newPayloadV2",e.engine_newPayloadV3="engine_newPayloadV3",e.eth_createAccessList="eth_createAccessList",e.eth_getProof="eth_getProof",e.eth_maxPriorityFeePerGas="eth_maxPriorityFeePerGas",e))(B||{}),k=class{get vet(){return s.YL.of(s.WU.formatEther(s.ie.of(this.balance)))}get vtho(){return s.gY.of(s.WU.formatEther(s.ie.of(this.energy)))}constructor(e){this.balance=e.balance,this.energy=e.energy,this.hasCode=e.hasCode}},I={PARAMS_ABI:[{constant:!1,inputs:[{name:"_key",type:"bytes32"},{name:"_value",type:"uint256"}],name:"set",outputs:[],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[{name:"_key",type:"bytes32"}],name:"get",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"executor",outputs:[{name:"",type:"address"}],payable:!1,stateMutability:"view",type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"key",type:"bytes32"},{indexed:!1,name:"value",type:"uint256"}],name:"Set",type:"event"}],PARAMS_ADDRESS:"0x0000000000000000000000000000506172616d73",ENERGY_ABI:[{constant:!0,inputs:[],name:"name",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!1,inputs:[{name:"_spender",type:"address"},{name:"_value",type:"uint256"}],name:"approve",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalSupply",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_amount",type:"uint256"}],name:"transferFrom",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"decimals",outputs:[{name:"",type:"uint8"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"}],name:"balanceOf",outputs:[{name:"balance",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[],name:"symbol",outputs:[{name:"",type:"string"}],payable:!1,stateMutability:"pure",type:"function"},{constant:!1,inputs:[{name:"_to",type:"address"},{name:"_amount",type:"uint256"}],name:"transfer",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!1,inputs:[{name:"_from",type:"address"},{name:"_to",type:"address"},{name:"_amount",type:"uint256"}],name:"move",outputs:[{name:"success",type:"bool"}],payable:!1,stateMutability:"nonpayable",type:"function"},{constant:!0,inputs:[],name:"totalBurned",outputs:[{name:"",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{constant:!0,inputs:[{name:"_owner",type:"address"},{name:"_spender",type:"address"}],name:"allowance",outputs:[{name:"remaining",type:"uint256"}],payable:!1,stateMutability:"view",type:"function"},{anonymous:!1,inputs:[{indexed:!0,name:"_from",type:"address"},{indexed:!0,name:"_to",type:"address"},{indexed:!1,name:"_value",type:"uint256"}],name:"Transfer",type:"event"},{anonymous:!1,inputs:[{indexed:!0,name:"_owner",type:"address"},{indexed:!0,name:"_spender",type:"address"},{indexed:!1,name:"_value",type:"uint256"}],name:"Approval",type:"event"}],ENERGY_ADDRESS:"0x0000000000000000000000000000456e65726779"},C=/^http:\/\//,x=/^https:\/\//,S=30,M=s.gN.of(s.Dy.of("Error(string)").bytes).toString().slice(0,10),E=s.gN.of(s.Dy.of("Panic(uint256)").bytes).toString().slice(0,10),A="https://mainnet.vechain.org",R="https://testnet.vechain.org",G="http://127.0.0.1:8669",N="https://ethereum.github.io/execution-apis/api-documentation/",F=e=>{let t={};for(let a in e)void 0!==e[a]&&(t[a]=e[a]);return t};async function D(e){await new Promise(t=>setTimeout(t,e))}var L=class extends l.EventEmitter{get getCurrentIteration(){return this.currentIteration}async _intervalLoop(){try{let e=await this.pollingFunction();this.emit("data",{data:e,eventPoll:this})}catch(e){e instanceof r.z3?(console.warn("Network error during polling, continuing:",e.message),this.emit("error",{error:e})):(this.error=new r.uX("EventPoll - main interval loop function","Error during the execution of the poll ".concat(e.message),{functionName:this.pollingFunction.name}),this.emit("error",{error:this.error})),this.hasToStopOnError&&this.stopListen()}this.currentIteration=this.currentIteration+1}onData(e){return this.on("data",t=>{e(t.data,t.eventPoll)}),this}onError(e){return this.on("error",t=>{e(t.error)}),this}onStart(e){return this.on("start",t=>{e(t.eventPoll)}),this}onStop(e){return this.on("stop",t=>{e(t.eventPoll)}),this}startListen(){this.emit("start",{eventPoll:this}),this._intervalLoop().then(()=>{this.intervalId=setInterval(()=>{(async()=>{try{await this._intervalLoop()}catch(e){console.error("EventPoll interval error:",e),this.hasToStopOnError&&this.stopListen()}})()},this.requestIntervalInMilliseconds)})}stopListen(){clearInterval(this.intervalId),this.emit("stop",{eventPoll:this})}constructor(e,t,a){if(super(),this.currentIteration=0,this.pollingFunction=e,this.hasToStopOnError=a,void 0!==t&&(t<=0||!Number.isInteger(t)))throw new r.I9("SyncPoll()",'Polling failed: Invalid input for field "options?.maximumWaitingTimeInMilliseconds" it must be a positive number',{requestIntervalInMilliseconds:t});this.requestIntervalInMilliseconds=t}},U={SyncPoll:function(e,t){if((null==t?void 0:t.requestIntervalInMilliseconds)!==void 0&&(t.requestIntervalInMilliseconds<=0||!Number.isInteger(t.requestIntervalInMilliseconds)))throw new r.I9("SyncPoll()",'Polling failed: Invalid input for field "options?.requestIntervalInMilliseconds" it must be a positive number',{requestIntervalInMilliseconds:t.requestIntervalInMilliseconds});if((null==t?void 0:t.maximumIterations)!==void 0&&(t.maximumIterations<=0||!Number.isInteger(t.maximumIterations)))throw new r.I9("SyncPoll()",'Polling failed: Invalid input for field "options?.maximumIterations" it must be a positive number',{maximumIterations:t.maximumIterations});if((null==t?void 0:t.maximumWaitingTimeInMilliseconds)!==void 0&&(t.maximumWaitingTimeInMilliseconds<=0||!Number.isInteger(t.maximumWaitingTimeInMilliseconds)))throw new r.I9("SyncPoll()",'Polling failed: Invalid input for field "options?.maximumWaitingTimeInMilliseconds" it must be a positive number',{maximumWaitingTimeInMilliseconds:t.maximumWaitingTimeInMilliseconds});let a=0,n,i=!1,o=Date.now();return{waitUntil:async s=>{let l=0,c=!1;try{do{var d,u;try{if(n=await e(),l=0,c=s(n))break}catch(a){if(a instanceof r.z3){if(++l>=10)throw new r.uX("SyncPoll.waitUntil()","Polling failed: Too many consecutive network errors.",{functionName:e.name},a);await D(null!==(d=null==t?void 0:t.requestIntervalInMilliseconds)&&void 0!==d?d:1e3);continue}throw a}await D(null!==(u=null==t?void 0:t.requestIntervalInMilliseconds)&&void 0!==u?u:1e3),a+=1;let h=(null==t?void 0:t.maximumIterations)!==void 0?a>=t.maximumIterations:a>=1e3,g=(null==t?void 0:t.maximumWaitingTimeInMilliseconds)!==void 0&&Date.now()-o>=t.maximumWaitingTimeInMilliseconds;if(i=!(c||h||g),a>=1e3)throw new r.uX("SyncPoll.waitUntil()","Polling failed: Maximum safe iterations reached.",{functionName:e.name})}while(i);return n}catch(t){throw new r.uX("SyncPoll.waitUntil()","Polling failed: Function execution error encountered during synchronous polling.",{functionName:e.name},t)}}}},createEventPoll:function(e,t){let a=!(arguments.length>2)||void 0===arguments[2]||arguments[2];return new L(e,t,a)}},O=e=>{let t=Object.entries(e).filter(e=>{let[,t]=e;return void 0!==t}).map(e=>{let[t,a]=e;return"".concat(encodeURIComponent(t),"=").concat(encodeURIComponent(a))});return t.length>0?"?".concat(t.join("&")):""},H=e=>{e=e.trim();let t=/^(https?:\/\/)([a-zA-Z0-9-]+(\.[a-zA-Z0-9-]+)*)(:\d+)?\/?$/;if(!t.test(e))throw new r.I9("sanitizeWebsocketBaseURL()","Invalid url: ".concat(e,". Must adhere to the regex: ").concat(t,"."),{url:e,urlRegex:t});return e=e.replace(/\/$/,""),e=null!==C.exec(e)?e.replace(C,"ws://"):e.replace(x,"wss://")},V={accounts:{get:{ACCOUNT_DETAIL:e=>"/accounts/".concat(e),ACCOUNT_BYTECODE:e=>"/accounts/".concat(e,"/code"),STORAGE_AT:(e,t)=>"/accounts/".concat(e,"/storage/").concat(t)},post:{SIMULATE_TRANSACTION:e=>null!=e?"/accounts/*?revision=".concat(e):"/accounts/*"}},blocks:{get:{BLOCK_DETAIL:e=>"/blocks/".concat(e)}},nodes:{get:{NODES:()=>"/node/network/peers"}},logs:{post:{EVENT_LOGS:()=>"/logs/event",TRANSFER_LOGS:()=>"/logs/transfer"}},transactions:{get:{TRANSACTION:e=>"/transactions/".concat(e),TRANSACTION_RECEIPT:e=>"/transactions/".concat(e,"/receipt")},post:{TRANSACTION:()=>"/transactions"}},subscriptions:{get:{BLOCK:(e,t)=>{let a=O({pos:t});return"".concat(H(e),"/subscriptions/block").concat(a)},EVENT:(e,t)=>{let a=O({pos:null==t?void 0:t.position,addr:null==t?void 0:t.contractAddress,t0:null==t?void 0:t.topic0,t1:null==t?void 0:t.topic1,t2:null==t?void 0:t.topic2,t3:null==t?void 0:t.topic3,t4:null==t?void 0:t.topic4});return"".concat(H(e),"/subscriptions/event").concat(a)},VET_TRANSFER:(e,t)=>{let a=O({pos:null==t?void 0:t.position,txOrigin:null==t?void 0:t.signerAddress,sender:null==t?void 0:t.sender,recipient:null==t?void 0:t.receiver});return"".concat(H(e),"/subscriptions/transfer").concat(a)},BEAT_LEGACY:(e,t)=>{let a=O({pos:t});return"".concat(H(e),"/subscriptions/beat").concat(a)},BEAT:(e,t)=>{let a=O({pos:t});return"".concat(H(e),"/subscriptions/beat2").concat(a)},NEW_TRANSACTIONS:e=>"".concat(H(e),"/subscriptions/txpool")}},debug:{post:{TRACE_TRANSACTION_CLAUSE:()=>"/debug/tracers",TRACE_CONTRACT_CALL:()=>"/debug/tracers/call",RETRIEVE_STORAGE_RANGE:()=>"/debug/storage-range"}},fees:{get:{FEES_HISTORY:(e,t,a)=>"/fees/history".concat(O({blockCount:e,newestBlock:t,rewardPercentiles:null==a?void 0:a.join(",")}))}}},j={getEventSubscriptionUrl:(e,t,a,n)=>{let i=new s.Vp(t).encodeFilterTopicsNoNull(null!=a?a:[]);return V.subscriptions.get.EVENT(e,{position:null==n?void 0:n.blockID,contractAddress:null==n?void 0:n.address,topic0:i[0],topic1:i[1],topic2:i[2],topic3:i[3],topic4:i[4]})},getBlockSubscriptionUrl:(e,t)=>V.subscriptions.get.BLOCK(e,null==t?void 0:t.blockID),getNewTransactionsSubscriptionUrl:e=>V.subscriptions.get.NEW_TRANSACTIONS(e),getVETtransfersSubscriptionUrl:(e,t)=>V.subscriptions.get.VET_TRANSFER(e,{position:null==t?void 0:t.blockID,signerAddress:null==t?void 0:t.signerAddress,sender:null==t?void 0:t.sender,receiver:null==t?void 0:t.recipient}),getLegacyBeatSubscriptionUrl:(e,t)=>V.subscriptions.get.BEAT_LEGACY(e,null==t?void 0:t.blockID),getBeatSubscriptionUrl:(e,t)=>V.subscriptions.get.BEAT(e,null==t?void 0:t.blockID)},q={[s.Qo.genesisBlock.id]:{registry:"0xa9231da8BF8D10e2df3f6E03Dd5449caD600129b",resolveUtils:"0xA11413086e163e41901bb81fdc5617c975Fa5a1A"},[s.fF.genesisBlock.id]:{registry:"0xcBFB30c1F267914816668d53AcBA7bA7c9806D13",resolveUtils:"0xc403b8EA53F707d7d4de095f0A20bC491Cf2bc94"},[s.r2.genesisBlock.id]:{registry:"0x1c4a602ed21f3d1dddd1142c81f231ef1a08c921",resolveUtils:"0xb2f08bbfa8a42b1fbe63feec604cb147385203d7"}},W={resolveName:async(e,t)=>{let[a]=await W.resolveNames(e.blocks,e.transactions,[t]);return null!=a?a:null},resolveNames:async(e,t,a)=>{var n;let i=await e.getGenesisBlock();if(null===i||!s.pV.isValid(null===(n=q[i.id])||void 0===n?void 0:n.resolveUtils))return a.map(()=>null);let o=q[i.id].resolveUtils,[r]=(await t.executeCall(o,s.ed.ofSignature(s.pS,"function getAddresses(string[] names) returns (address[] addresses)"),[a])).result.array;return r.map(e=>e!==s.cF&&s.pV.isValid(e)?e:null)},lookupAddress:async(e,t)=>{let[a]=await W.lookupAddresses(e,[t]);return null!=a?a:null},lookupAddresses:async(e,t)=>{var a;let n=await e.blocks.getGenesisBlock();if(null===n||!s.pV.isValid(null===(a=q[n.id])||void 0===a?void 0:a.resolveUtils))return t.map(()=>null);let i=q[n.id].resolveUtils,[o]=(await e.contracts.executeCall(i,s.ed.ofSignature(s.pS,"function getNames(address[] addresses) returns (string[] names)"),[t])).result.array;return o.map(e=>""===e?null:e)}},K=class{async getAccount(e,t){var a;let n=null==t?void 0:null===(a=t.revision)||void 0===a?void 0:a.toString();return new k(await this.httpClient.get(V.accounts.get.ACCOUNT_DETAIL(e.toString()),{query:F({revision:n})}))}async getBytecode(e,t){var a;let n=null==t?void 0:null===(a=t.revision)||void 0===a?void 0:a.toString(),i=await this.httpClient.get(V.accounts.get.ACCOUNT_BYTECODE(e.toString()),{query:F({revision:n})});return s.MI.of(i.code)}async getStorageAt(e,t,a){var n;let i=t.toString(),o=null==a?void 0:null===(n=a.revision)||void 0===n?void 0:n.toString(),r=await this.httpClient.get(V.accounts.get.STORAGE_AT(e.toString(),i),{query:F({pos:i,revision:o})});return s.MI.of(r.value)}constructor(e){this.httpClient=e}},z=class{destroy(){null!=this.pollInstance&&this.pollInstance.stopListen()}setupPolling(){var e;this.pollInstance=U.createEventPoll(async()=>await this.getBestBlockCompressed(),1e4).onData(e=>{this.headBlock=e}).onError(null!==(e=this.onBlockError)&&void 0!==e?e:()=>{}),this.pollInstance.startListen()}async getBlockCompressed(e){if(null!=e&&!s.AT.isValid(e))throw new r.I9("BlocksModule.getBlockCompressed()",'Invalid revision. The revision must be a string representing a block number or block id (also "best" is accepted which represents the best block & "finalized" for the finalized block).',{revision:e});return await this.httpClient.http("GET",V.blocks.get.BLOCK_DETAIL(e))}async getBlockExpanded(e){if(null!=e&&!s.AT.isValid(e))throw new r.I9("BlocksModule.getBlockExpanded()",'Invalid revision. The revision must be a string representing a block number or block id (also "best" is accepted which represents the best block & "finalized" for the finalized block).',{revision:e});return await this.httpClient.http("GET",V.blocks.get.BLOCK_DETAIL(e),{query:F({expanded:!0})})}async getBestBlockCompressed(){return await this.getBlockCompressed("best")}async getBestBlockExpanded(){return await this.getBlockExpanded("best")}async getBestBlockBaseFeePerGas(){var e;let t=await this.getBestBlockCompressed();return null===t?null:null!==(e=t.baseFeePerGas)&&void 0!==e?e:null}async getBestBlockRef(){let e=await this.getBestBlockCompressed();return null===e?null:e.id.slice(0,18)}async getFinalBlockCompressed(){return await this.getBlockCompressed("finalized")}async getFinalBlockExpanded(){return await this.getBlockExpanded("finalized")}async _waitForBlock(e,t,a){if(null!=e&&e<=0)throw new r.I9("BlocksModule.waitForBlock()","Invalid blockNumber. The blockNumber must be a number representing a block number.",{blockNumber:e});return await U.SyncPoll(async()=>t?await this.getBlockExpanded(e):await this.getBlockCompressed(e),{requestIntervalInMilliseconds:null==a?void 0:a.intervalMs,maximumWaitingTimeInMilliseconds:null==a?void 0:a.timeoutMs}).waitUntil(t=>null!=t&&t.number==e)}async waitForBlockCompressed(e,t){return await this._waitForBlock(e,!1,t)}async waitForBlockExpanded(e,t){return await this._waitForBlock(e,!0,t)}getHeadBlock(){return this.headBlock}async getGenesisBlock(){return await this.getBlockCompressed(0)}getAllAddressesIntoABlock(e){let t=new Set;return t.add(e.beneficiary),t.add(e.signer),e.transactions.forEach(e=>{e.clauses.forEach(e=>{"string"==typeof e.to&&t.add(e.to)}),t.add(e.gasPayer),t.add(e.origin),e.outputs.forEach(e=>{"string"==typeof e.contractAddress&&t.add(e.contractAddress),e.events.forEach(e=>{t.add(e.address)}),e.transfers.forEach(e=>{t.add(e.recipient),t.add(e.sender)})})}),Array.from(t)}constructor(e,t){this.headBlock=null,this.httpClient=e,this.onBlockError=null==t?void 0:t.onBlockError,(null==t?void 0:t.isPollingEnabled)===!0&&this.setupPolling()}},Q=class{async get(e){var t,a,n;let i={range:null!==(a=null==e?void 0:e.range)&&void 0!==a?a:{unit:"block",from:0,to:null===(t=await this.contract.contractsModule.transactionsModule.blocksModule.getBestBlockCompressed())||void 0===t?void 0:t.number},criteriaSet:this.criteriaSet,options:null==e?void 0:e.options,order:null!==(n=null==e?void 0:e.order)&&void 0!==n?n:"asc"};return await this.contract.contractsModule.transactionsModule.logsModule.filterEventLogs(i)}constructor(e,t){this.contract=e,this.criteriaSet=t}};function J(e,t,a){let n=e.getEventAbi(t),i=new Map(n.encodeFilterTopicsNoNull(a).map((e,t)=>[t,e]));return{criteria:{address:e.address,topic0:i.get(0),topic1:i.has(1)?i.get(1):void 0,topic2:i.has(2)?i.get(2):void 0,topic3:i.has(3)?i.get(3):void 0,topic4:i.has(4)?i.get(4):void 0},eventAbi:n}}function Y(e){let t=function(e){let t=e.find(e=>Z(e));if(t)return{value:t.value.toString()}}(e),a=e.find(e=>X(e)),n=e.find(e=>$(e));return(void 0!==t||void 0!==a||void 0!==n)&&(e=e.filter(e=>!(Z(e)||X(e)||$(e)))),{args:e,clauseAdditionalOptions:{value:null==t?void 0:t.value,comment:null==a?void 0:a.comment,revision:null==n?void 0:n.revision}}}function Z(e){return void 0!==e.value}function X(e){return void 0!==e.comment}function $(e){return void 0!==e.revision}var ee=class{setContractReadOptions(e){return this.contractCallOptions=e,this.contractCallOptions}getContractReadOptions(){return this.contractCallOptions}clearContractReadOptions(){this.contractCallOptions={}}setContractTransactOptions(e){return this.contractTransactionOptions=e,this.contractTransactionOptions}getContractTransactOptions(){return this.contractTransactionOptions}clearContractTransactOptions(){this.contractTransactionOptions={}}setSigner(e){return this.signer=e,this.signer}getSigner(){return this.signer}getFunctionAbi(e){return s.ro.ofAbi(this.abi).getFunction(e.toString())}getEventAbi(e){return s.ro.ofAbi(this.abi).getEvent(e.toString())}constructor(e,t,a,n,i){this.read={},this.transact={},this.filters={},this.clause={},this.criteria={},this.contractCallOptions={},this.contractTransactionOptions={},this.abi=t,this.address=e,this.contractsModule=a,this.deployTransactionReceipt=i,this.signer=n,this.read=function(e){return new Proxy(e.read,{get:(t,a)=>async function(){for(var t,n,i,o,s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];let d=Y(l),u=null===(t=d.clauseAdditionalOptions)||void 0===t?void 0:t.comment,h=null===(n=d.clauseAdditionalOptions)||void 0===n?void 0:n.revision,g=e.getFunctionAbi(a),p=await e.contractsModule.executeCall(e.address,g,d.args,{caller:void 0!==e.getSigner()?await (null===(i=e.getSigner())||void 0===i?void 0:i.getAddress()):void 0,...e.getContractReadOptions(),comment:u,revision:h,includeABI:!0});if(!p.success)throw new r.rq(g.stringSignature,p.result.errorMessage,{contractAddress:e.address});return null!==(o=p.result.array)&&void 0!==o?o:[]}})}(this),this.transact=function(e){return new Proxy(e.transact,{get:(t,a)=>async function(){for(var t,n,i,o,s=arguments.length,l=Array(s),c=0;c<s;c++)l[c]=arguments[c];if(void 0===e.getSigner())throw new r.w5("getTransactProxy()","Caller signer is required to transact with the contract.",{fieldName:"signer",prop:a});let d=e.getContractTransactOptions(),u=Y(l),h=null===(t=u.clauseAdditionalOptions)||void 0===t?void 0:t.value,g=null===(n=u.clauseAdditionalOptions)||void 0===n?void 0:n.comment;return l=u.args,await e.contractsModule.executeTransaction(e.getSigner(),e.address,e.getFunctionAbi(a),l,{...d,value:null!==(o=null!==(i=d.value)&&void 0!==i?i:h)&&void 0!==o?o:"0x0",comment:g,includeABI:!0})}})}(this),this.filters=function(e){return new Proxy(e.filters,{get:(t,a)=>t=>{let n=J(e,a,t);return new Q(e,[n])}})}(this),this.clause=function(e){return new Proxy(e.clause,{get:(t,a)=>function(){for(var t,n,i,o,r=arguments.length,l=Array(r),c=0;c<r;c++)l[c]=arguments[c];let d=e.getContractTransactOptions(),u=Y(l),h=null===(t=u.clauseAdditionalOptions)||void 0===t?void 0:t.value,g=null===(n=u.clauseAdditionalOptions)||void 0===n?void 0:n.comment;return l=u.args,{clause:s.y4.callFunction(s.pV.of(e.address),e.getFunctionAbi(a),l,s.YL.of(null!==(o=null!==(i=d.value)&&void 0!==i?i:h)&&void 0!==o?o:0,s.WU.wei),{comment:g,includeABI:!0}),functionAbi:e.getFunctionAbi(a)}}})}(this),this.criteria=function(e){return new Proxy(e.criteria,{get:(t,a)=>t=>J(e,a,t)})}(this)}},et=class{async startDeployment(e,t){let a=s.y4.deployContract(s.MI.of(this.bytecode),e),n=await this.contractsModule.transactionsModule.estimateGas([a],await this.signer.getAddress(),t),i=await this.contractsModule.transactionsModule.buildTransactionBody([a],n.totalGas,t),o=await this.signer.signTransaction(P.transactionBodyToTransactionRequestInput(i,await this.signer.getAddress()));return this.deployTransaction=await this.contractsModule.transactionsModule.sendTransaction(s.ZX.decode(s.MI.of(o.slice(2)).bytes,!0)),this}async waitForDeployment(){var e,t,a;if((null===(e=this.deployTransaction)||void 0===e?void 0:e.id)===void 0)throw new r.Bb("ContractFactory.waitForDeployment()","Cannot find a contract deployment transaction",{networkUrl:this.contractsModule.transactionsModule.blocksModule.httpClient.baseURL});let n=await this.deployTransaction.wait();if((null==n?void 0:null===(t=n.outputs[0])||void 0===t?void 0:t.contractAddress)===null||(null==n?void 0:null===(a=n.outputs[0])||void 0===a?void 0:a.contractAddress)===void 0)throw new r.fL("ContractFactory.waitForDeployment()","Contract deployment failed.",{deployTransaction:this.deployTransaction});return new ee(null==n?void 0:n.outputs[0].contractAddress,this.abi,this.contractsModule,this.signer,n)}getDeployTransaction(){return this.deployTransaction}constructor(e,t,a,n){this.abi=e,this.bytecode=t,this.signer=a,this.contractsModule=n}},ea=class{createContractFactory(e,t,a){return new et(e,t,a,this)}load(e,t,a){return new ee(e,t,this,a)}async executeCall(e,t,a,n){return await this.transactionsModule.executeCall(e,t,a,n)}async executeMultipleClausesCall(e,t){return e.every(e=>"clause"in e),await this.transactionsModule.executeMultipleClausesCall(e,t)}async executeTransaction(e,t,a,n,i){return await this.transactionsModule.executeTransaction(e,t,a,n,i)}async executeMultipleClausesTransaction(e,t,a){return await this.transactionsModule.executeMultipleClausesTransaction(e,t,a)}async getLegacyBaseGasPrice(){return await this.transactionsModule.getLegacyBaseGasPrice()}constructor(e){this.transactionsModule=e}},en=class{async retrieveStorageRange(e){var t,a,n,i,o;this.validateTarget(e.target,"retrieveStorageRange");let r="".concat(e.target.blockId,"/").concat(e.target.transaction,"/").concat(e.target.clauseIndex);return await this.httpClient.post(V.debug.post.RETRIEVE_STORAGE_RANGE(),{query:{},body:{target:r,address:null===(a=e.options)||void 0===a?void 0:null===(t=a.address)||void 0===t?void 0:t.toString(),keyStart:null===(i=e.options)||void 0===i?void 0:null===(n=i.keyStart)||void 0===n?void 0:n.toString(),maxResult:null===(o=e.options)||void 0===o?void 0:o.maxResult},headers:{}})}async traceContractCall(e,t){var a,n,i,o,r,l,c,d,u,h,g,p,m;return await this.httpClient.post(V.debug.post.TRACE_CONTRACT_CALL(),{query:{},body:{to:null===(n=e.target)||void 0===n?void 0:null===(a=n.to)||void 0===a?void 0:a.toString(),data:null===(o=e.target)||void 0===o?void 0:null===(i=o.data)||void 0===i?void 0:i.toString(),value:"bigint"==typeof(null===(l=e.target)||void 0===l?void 0:null===(r=l.value)||void 0===r?void 0:r.wei)?s.MI.of(e.target.value.wei).toString():void 0,name:t,gas:null===(c=e.options)||void 0===c?void 0:c.gas,gasPrice:null===(d=e.options)||void 0===d?void 0:d.gasPrice,caller:null===(u=e.options)||void 0===u?void 0:u.caller,provedWork:null===(h=e.options)||void 0===h?void 0:h.provedWork,gasPayer:null===(g=e.options)||void 0===g?void 0:g.gasPayer,expiration:null===(p=e.options)||void 0===p?void 0:p.expiration,blockRef:null===(m=e.options)||void 0===m?void 0:m.blockRef,config:e.config},headers:{}})}async traceTransactionClause(e,t){this.validateTarget(e.target,"traceTransactionClause");let a="".concat(e.target.blockId,"/").concat(e.target.transaction,"/").concat(e.target.clauseIndex);return await this.httpClient.post(V.debug.post.TRACE_TRANSACTION_CLAUSE(),{query:{},body:{target:a,name:t,config:e.config},headers:{}})}validateTarget(e,t){if("number"==typeof e.transaction&&e.transaction<0)throw new r.I9("DebugModule.validateTarget()","invalid transaction index '".concat(e.transaction,"' given as input for ").concat(t,"."),{transaction:e.transaction,functionName:t});if(e.clauseIndex<0)throw new r.I9("DebugModule.validateTarget()","invalid clause index '".concat(e.clauseIndex,"' given as input for ").concat(t,"."),{clauseIndex:e.clauseIndex,functionName:t})}constructor(e){this.httpClient=e}},ei=class{setTransactionsModule(e){this.transactionsModule=e}async estimateGas(e,t,a){if(null==this.transactionsModule)throw new r.I9("estimateGas()","Transactions module not set",{});return await this.transactionsModule.estimateGas(e,t,a)}async getMaxPriorityFeePerGas(){let e=await this.httpClient.get("/fees/priority");if(null==e||"object"!=typeof e)throw new r.I9("getMaxPriorityFeePerGas()","Invalid response format from /fees/priority endpoint",{response:e});if(void 0===e.maxPriorityFeePerGas||null===e.maxPriorityFeePerGas||""===e.maxPriorityFeePerGas||"string"!=typeof e.maxPriorityFeePerGas)throw new r.I9("getMaxPriorityFeePerGas()","Missing or invalid maxPriorityFeePerGas in response",{response:e});return e.maxPriorityFeePerGas}async getFeeHistory(e){if(null==e||"number"!=typeof e.blockCount||!Number.isFinite(e.blockCount)||e.blockCount<=0)throw new r.I9("getFeeHistory()","Invalid blockCount parameter",{options:e});if(null!==e.newestBlock&&void 0!==e.newestBlock&&!s.AT.isValid(e.newestBlock))throw new r.I9("getFeeHistory()",'Invalid revision. The revision must be a string representing a block number or block id (also "best" is accepted which represents the best block & "finalized" for the finalized block).',{options:e});let t=await this.httpClient.http("GET",V.fees.get.FEES_HISTORY(e.blockCount,e.newestBlock,e.rewardPercentiles));if(null==t||"object"!=typeof t)throw new r.I9("getFeeHistory()","Invalid response format from /fees/history endpoint",{response:t});return t}async getNextBlockBaseFeePerGas(){let e=await this.getFeeHistory({blockCount:1,newestBlock:"next"});return null===e.baseFeePerGas||void 0===e.baseFeePerGas||0===e.baseFeePerGas.length?null:s.MI.of(e.baseFeePerGas[0]).bi}constructor(e){this.httpClient=e,this.transactionsModule=null}},eo=class{async filterRawEventLogs(e){return await this.blocksModule.httpClient.http("POST",V.logs.post.EVENT_LOGS(),{query:{},body:e,headers:{}})}async filterEventLogs(e){var t;let a=null===(t=e.criteriaSet)||void 0===t?void 0:t.map(e=>e.eventAbi),n=await this.getRawEventLogs(e),i=[];if(void 0!==a){let e=this.removeDuplicatedAbis(a);n.forEach(t=>{let a=e.get(t.topics[0]);if(null==a)throw new r.fd("LogsModule.filterEventLogs","Topic not found in the provided ABIs.",{type:"event",value:t.topics[0]});t.decodedData=a.decodeEventLogAsArray({data:s._h.of(t.data),topics:t.topics.map(e=>s._h.of(e))}),i.push(t)})}return i}async filterGroupedEventLogs(e){var t;let a=null===(t=e.criteriaSet)||void 0===t?void 0:t.map(e=>e.eventAbi),n=await this.getRawEventLogs(e),i=new Map;if(void 0!==a){let e=this.removeDuplicatedAbis(a);e.forEach(e=>i.set(e.signatureHash,[])),n.forEach(t=>{var a;let n=e.get(t.topics[0]);if(null==n)throw new r.fd("LogsModule.filterGroupedEventLogs","Topic not found in the provided ABIs.",{type:"event",value:t.topics[0]});t.decodedData=n.decodeEventLogAsArray({data:s._h.of(t.data),topics:t.topics.map(e=>s._h.of(e))}),null===(a=i.get(t.topics[0]))||void 0===a||a.push(t)})}return Array.from(i.values())}async getRawEventLogs(e){var t,a,n,i;let o=null===(t=e.criteriaSet)||void 0===t?void 0:t.map(e=>e.criteria),r={range:null!==(n=e.range)&&void 0!==n?n:{unit:"block",from:0,to:null===(a=await this.blocksModule.getBestBlockCompressed())||void 0===a?void 0:a.number},criteriaSet:o,options:e.options,order:null!==(i=e.order)&&void 0!==i?i:"asc"};return await this.filterRawEventLogs(r)}removeDuplicatedAbis(e){let t=new Map;return e.forEach(e=>{t.has(e.signatureHash)||t.set(e.signatureHash,e)}),t}async filterTransferLogs(e){return await this.blocksModule.httpClient.http("POST",V.logs.post.TRANSFER_LOGS(),{query:{},body:e,headers:{}})}constructor(e){this.blocksModule=e}},er=new WeakMap,es=class{async getNodes(){var e;return null!==(e=await this.blocksModule.httpClient.http("GET",V.nodes.get.NODES()))&&void 0!==e?e:[]}async isHealthy(){let e=await this.blocksModule.getBestBlockCompressed(),t=this.getTimestampFromBlock(e);return 30>Math.abs(Math.floor(Date.now()/1e3)-t)}async getChaintag(){let e=er.get(this.blocksModule);if(void 0!==e)return e;let t=await this.blocksModule.getGenesisBlock();if(!(null==t?void 0:t.id))throw new r.I9("NodesModule.getChaintag()","The genesis block id is null or undefined. Unable to get the chain tag.",{url:this.blocksModule.httpClient.baseURL});let a=+"0x".concat(t.id.slice(-2));if(Number.isNaN(a))throw new r.I9("NodesModule.getChaintag()","Invalid genesis block id. Unable to derive chain tag.",{id:t.id});return er.set(this.blocksModule,a),a}constructor(e){this.getTimestampFromBlock=e=>{if(null==e||"object"!=typeof e||!("timestamp"in e)||"number"!=typeof e.timestamp)throw new r.I9("NodesModule.getTimestampFromBlock()","Sending failed: Input must be a valid raw transaction in hex format.",{response:e});return null==e?void 0:e.timestamp},this.blocksModule=e}},el=s.gN.of(s.Dy.of("Error(string)").bytes).toString().slice(0,10),ec=s.gN.of(s.Dy.of("Panic(uint256)").bytes).toString().slice(0,10);function ed(e){if(e.startsWith(el))return s.pQ.ofEncoded("string","0x"+e.slice(el.length)).getFirstDecodedValue();if(e.startsWith(ec)){let t=s.pQ.ofEncoded("uint256","0x"+e.slice(ec.length)).getFirstDecodedValue();return"Panic(0x".concat(parseInt(t).toString(16).padStart(2,"0"),")")}}var eu=class{async getTransaction(e,t){if(!s.lM.isValid(e))throw new r.I9("TransactionsModule.getTransaction()","Invalid transaction ID given as input. Input must be an hex string of length 64.",{id:e});if((null==t?void 0:t.head)!==void 0&&!s.lM.isValid(t.head))throw new r.I9("TransactionsModule.getTransaction()","Invalid head given as input. Input must be an hex string of length 64.",{head:null==t?void 0:t.head});return await this.blocksModule.httpClient.http("GET",V.transactions.get.TRANSACTION(e),{query:F({raw:!1,head:null==t?void 0:t.head,pending:null==t?void 0:t.pending})})}async getTransactionRaw(e,t){if(!s.lM.isValid(e))throw new r.I9("TransactionsModule.getTransactionRaw()","Invalid transaction ID given as input. Input must be an hex string of length 64.",{id:e});if((null==t?void 0:t.head)!==void 0&&!s.lM.isValid(t.head))throw new r.I9("TransactionsModule.getTransaction()","Invalid head given as input. Input must be an hex string of length 64.",{head:null==t?void 0:t.head});return await this.blocksModule.httpClient.http("GET",V.transactions.get.TRANSACTION(e),{query:F({raw:!0,head:null==t?void 0:t.head,pending:null==t?void 0:t.pending})})}async getTransactionReceipt(e,t){if(!s.lM.isValid(e))throw new r.I9("TransactionsModule.getTransactionReceipt()","Invalid transaction ID given as input. Input must be an hex string of length 64.",{id:e});if((null==t?void 0:t.head)!==void 0&&!s.lM.isValid(t.head))throw new r.I9("TransactionsModule.getTransaction()","Invalid head given as input. Input must be an hex string of length 64.",{head:null==t?void 0:t.head});try{return await this.blocksModule.httpClient.http("GET",V.transactions.get.TRANSACTION_RECEIPT(e),{query:F({head:null==t?void 0:t.head})})}catch(e){if(e instanceof r.z3)return null;throw e}}async sendRawTransaction(e){if(!s._h.isValid0x(e))throw new r.I9("TransactionsModule.sendRawTransaction()","Sending failed: Input must be a valid raw transaction in hex format.",{raw:e});try{s.ZX.decode(s.MI.of(e.slice(2)).bytes,!0)}catch(t){throw new r.I9("TransactionsModule.sendRawTransaction()","Sending failed: Input must be a valid raw transaction in hex format. Decoding error encountered.",{raw:e},t)}let t=await this.blocksModule.httpClient.http("POST",V.transactions.post.TRANSACTION(),{body:{raw:e}});return{id:t.id,wait:async()=>await this.waitForTransaction(t.id)}}async sendTransaction(e){if(!e.isSigned)throw new r.I9("TransactionsModule.sendTransaction()","Invalid transaction given as input. Transaction must be signed.",{signedTx:e});let t=s._h.of(e.encoded).toString();return await this.sendRawTransaction(t)}async waitForTransaction(e,t){var a;if(!s.lM.isValid(e))throw new r.I9("TransactionsModule.waitForTransaction()","Invalid transaction ID given as input. Input must be an hex string of length 64.",{txID:e});if((null==t?void 0:t.timeoutMs)===void 0)return await U.SyncPoll(async()=>await this.getTransactionReceipt(e),{requestIntervalInMilliseconds:null==t?void 0:t.intervalMs,maximumWaitingTimeInMilliseconds:null==t?void 0:t.timeoutMs}).waitUntil(e=>null!==e);let n=Date.now()+t.timeoutMs,i=null!==(a=null==t?void 0:t.intervalMs)&&void 0!==a?a:1e3;for(;;){if(Date.now()>=n)return null;let t=await this.getTransactionReceipt(e).catch(()=>null);if(null!==t)return t;await new Promise(e=>setTimeout(e,i))}}async buildTransactionBody(e,t,a){var n,i,o,l,c;let d=await this.blocksModule.getBlockCompressed(0);if(null===d)throw new r.w5("TransactionsModule.buildTransactionBody()","Error while building transaction body: Cannot get genesis block.",{fieldName:"genesisBlock",genesisBlock:d,clauses:e,options:a});let u=null!==(n=null==a?void 0:a.blockRef)&&void 0!==n?n:await this.blocksModule.getBestBlockRef();if(null===u)throw new r.w5("TransactionsModule.buildTransactionBody()","Error while building transaction body: Cannot get blockRef.",{fieldName:"blockRef",blockRef:u,clauses:e,options:a});let h=null!==(i=null==a?void 0:a.chainTag)&&void 0!==i?i:+"0x".concat(d.id.slice(-2)),g=await this.fillDefaultBodyOptions(a),p;return p=Array.isArray(e)?e.map(e=>({to:e.to,data:e.data,value:e.value})):[{to:e.to,data:e.data,value:e.value}],{blockRef:u,chainTag:h,clauses:await this.resolveNamesInClauses(p),dependsOn:null!==(o=null==a?void 0:a.dependsOn)&&void 0!==o?o:null,expiration:null!==(l=null==a?void 0:a.expiration)&&void 0!==l?l:32,gas:(null==a?void 0:a.gas)!==void 0?Number(a.gas):t,gasPriceCoef:null==g?void 0:g.gasPriceCoef,maxFeePerGas:null==g?void 0:g.maxFeePerGas,maxPriorityFeePerGas:null==g?void 0:g.maxPriorityFeePerGas,nonce:null!==(c=null==a?void 0:a.nonce)&&void 0!==c?c:s._h.random(8).toString(),reserved:(null==a?void 0:a.isDelegated)===!0?{features:1}:void 0}}async fillTransactionBody(e){let t={maxFeePerGas:e.maxFeePerGas,maxPriorityFeePerGas:e.maxPriorityFeePerGas,gasPriceCoef:e.gasPriceCoef},a=await this.fillDefaultBodyOptions(t);return{...e,...a}}async fillDefaultBodyOptions(e){null!=e||(e={});let t=void 0!==e.maxFeePerGas,a=void 0!==e.maxPriorityFeePerGas,n=void 0!==e.gasPriceCoef;if(a&&n&&!t)throw new r.I9("TransactionsModule.fillDefaultBodyOptions()","Invalid parameter combination: maxPriorityFeePerGas and gasPriceCoef cannot be used together without maxFeePerGas.",{options:e});if(t&&n&&!a)throw new r.I9("TransactionsModule.fillDefaultBodyOptions()","Invalid parameter combination: maxFeePerGas and gasPriceCoef cannot be used together without maxPriorityFeePerGas.",{options:e});if(a&&t&&n)e.gasPriceCoef=void 0;else if(a&&t)e.gasPriceCoef=void 0;else if(n&&!a&&!t)return e.maxFeePerGas=void 0,e.maxPriorityFeePerGas=void 0,e;let i=await this.forkDetector.isGalacticaForked("best");if(!i&&(t||a))throw new r.I9("TransactionsModule.fillDefaultBodyOptions()","Invalid transaction body options. Dynamic fee tx is not allowed before Galactica fork.",{options:e});if(!i&&!n)return e.gasPriceCoef=0,e;if(i&&t&&a)return e;e.gasPriceCoef=void 0;let o=await this.gasModule.getNextBlockBaseFeePerGas();if(null==o)throw new r.I9("TransactionsModule.fillDefaultBodyOptions()","Invalid transaction body options. Unable to get next block base fee per gas.",{options:e});if(void 0===e.maxPriorityFeePerGas||null===e.maxPriorityFeePerGas){let t=await this.calculateDefaultMaxPriorityFeePerGas(o);e.maxPriorityFeePerGas=t}if(void 0===e.maxFeePerGas||null===e.maxFeePerGas){let t=s.MI.of(e.maxPriorityFeePerGas).bi;e.maxFeePerGas=s.MI.of(112n*o/100n+t).toString()}return e}async calculateDefaultMaxPriorityFeePerGas(e){let t=await this.gasModule.getFeeHistory({blockCount:10,newestBlock:"best",rewardPercentiles:[25,50,75]}),a;if(null!==t.reward&&void 0!==t.reward&&t.reward.length>0){let e=t.reward[t.reward.length-1];if(3===new Set(e).size)a=s.MI.of(e[2]).bi;else{let e=0n,n=0;for(let a of t.reward)null!==a.length&&a.length>2&&null!==a[2]&&void 0!==a[2]&&(e+=s.MI.of(a[2]).bi,n++);a=n>0?e/BigInt(n):0n}}else a=s.MI.of(await this.gasModule.getMaxPriorityFeePerGas()).bi;let n=46n*e/1000n,i=n<a?n:a;return s.MI.of(i).toString()}async resolveNamesInClauses(e){let t=e.reduce((e,t)=>("string"==typeof t.to&&!e.has(t.to)&&t.to.includes(".")&&e.set(t.to,t.to),e),new Map),a=[...t.keys()];return 0===t.size?e:((await W.resolveNames(this.blocksModule,this,a)).forEach((e,n)=>{null!==e&&t.set(a[n],e)}),e.map(e=>{var a;return"string"!=typeof e.to?e:{to:null!==(a=t.get(e.to))&&void 0!==a?a:e.to,data:e.data,value:e.value}}))}async simulateTransaction(e,t){let{revision:a,caller:n,gasPrice:i,gasPayer:o,gas:l,blockRef:c,expiration:d,provedWork:u}=null!=t?t:{};if(null!=a&&!s.AT.isValid(a.toString()))throw new r.I9("TransactionsModule.simulateTransaction()","Invalid revision given as input. Input must be a valid revision (i.e., a block number or block ID).",{revision:a});return await this.blocksModule.httpClient.http("POST",V.accounts.post.SIMULATE_TRANSACTION(null==a?void 0:a.toString()),{query:F({revision:null==a?void 0:a.toString()}),body:{clauses:await this.resolveNamesInClauses(e.map(e=>({to:e.to,data:e.data,value:BigInt(e.value).toString()}))),gas:l,gasPrice:i,caller:n,provedWork:u,gasPayer:o,expiration:d,blockRef:c}})}decodeRevertReason(e,t){if(e.startsWith(M))return s.pQ.ofEncoded("string","0x".concat(e.slice(M.length))).getFirstDecodedValue();if(e.startsWith(E)){let t=s.pQ.ofEncoded("uint256","0x".concat(e.slice(E.length))).getFirstDecodedValue();return"Panic(0x".concat(parseInt(t).toString(16).padStart(2,"0"),")")}return void 0!==t?new c.KA([d.bp.from(t)]).decodeErrorResult(d.bp.from(t),e).toArray()[0]:""}async getRevertReason(e,t){let a=this.blocksModule,n=this.debugModule,i=await this.getTransaction(e),o=null!==i?await a.getBlockExpanded(i.meta.blockID):null;if(null===o||null===i)return null;let r=eM(eN.formatToRPCStandard(o,""),e);for(let e=0;e<i.clauses.length;e++){let a=await n.traceTransactionClause({target:{blockId:s.lM.of(o.id),transaction:r,clauseIndex:e},config:{OnlyTopCall:!0}},"call");if(void 0!==a.output)return this.decodeRevertReason(a.output,t)}return null}async estimateGas(e,t,a){var n;let i=e.map(e=>{if(void 0===e)throw new r.I9("TransactionsModule.estimateGas()","Invalid ContractClause provided: missing inner clause.",{clause:e});return"clause"in e?e.clause:e});if(0===i.length)throw new r.I9("TransactionsModule.estimateGas()","Invalid clauses. Clauses must be an array with at least one clause.",{clauses:e,caller:t,options:a});if((null==a?void 0:a.gasPadding)!==void 0&&(a.gasPadding<=0||a.gasPadding>1))throw new r.I9("GasModule.estimateGas()","Invalid gasPadding. gasPadding must be a number between (0, 1].",{gasPadding:null==a?void 0:a.gasPadding});let o=await this.simulateTransaction(i,{caller:t,...a}),l=o.some(e=>e.reverted),c=Number(s.ZX.intrinsicGas(i).wei),d=o.reduce((e,t)=>e+t.gasUsed,0),u=Math.ceil((c+(0!==d?d+15e3:0))*(1+(null!==(n=null==a?void 0:a.gasPadding)&&void 0!==n?n:0)));return l?{totalGas:u,reverted:!0,revertReasons:o.map(e=>{var t;return null!==(t=ed(e.data))&&void 0!==t?t:""}),vmErrors:o.map(e=>e.vmError)}:{totalGas:u,reverted:!1,revertReasons:[],vmErrors:[]}}async executeCall(e,t,a,n){let i=await this.simulateTransaction([{to:e,value:"0",data:t.encodeData(a).toString()}],n);return this.getContractCallResult(i[0].data,t,i[0].reverted)}async executeMultipleClausesCall(e,t){return(await this.simulateTransaction(e.map(e=>{if(void 0===e.clause)throw new r.I9("TransactionsModule.executeMultipleClausesCall()","Invalid ContractClause provided: missing inner clause.",{clause:e});return e.clause}),t)).map((t,a)=>this.getContractCallResult(t.data,e[a].functionAbi,t.reverted))}async executeTransaction(e,t,a,n,i){var o;let r=await e.sendTransaction({clauses:[s.y4.callFunction(s.pV.of(t),a,n,s.YL.of(null!==(o=null==i?void 0:i.value)&&void 0!==o?o:0,s.WU.wei))],gas:null==i?void 0:i.gas,gasLimit:null==i?void 0:i.gasLimit,gasPrice:null==i?void 0:i.gasPrice,gasPriceCoef:null==i?void 0:i.gasPriceCoef,maxFeePerGas:null==i?void 0:i.maxFeePerGas,maxPriorityFeePerGas:null==i?void 0:i.maxPriorityFeePerGas,nonce:null==i?void 0:i.nonce,value:null==i?void 0:i.value,dependsOn:null==i?void 0:i.dependsOn,expiration:null==i?void 0:i.expiration,chainTag:null==i?void 0:i.chainTag,blockRef:null==i?void 0:i.blockRef,delegationUrl:null==i?void 0:i.delegationUrl,comment:null==i?void 0:i.comment});return{id:r,wait:async()=>await this.waitForTransaction(r)}}async executeMultipleClausesTransaction(e,t,a){let n=await t.sendTransaction({clauses:e.map(e=>{if(void 0===e)throw new r.I9("TransactionsModule.executeMultipleClausesTransaction()","Invalid ContractClause[] | TransactionClause[] provided: missing clause.",{clause:e});return"clause"in e?e.clause:e}),gas:null==a?void 0:a.gas,gasLimit:null==a?void 0:a.gasLimit,gasPrice:null==a?void 0:a.gasPrice,gasPriceCoef:null==a?void 0:a.gasPriceCoef,maxFeePerGas:null==a?void 0:a.maxFeePerGas,maxPriorityFeePerGas:null==a?void 0:a.maxPriorityFeePerGas,nonce:null==a?void 0:a.nonce,value:null==a?void 0:a.value,dependsOn:null==a?void 0:a.dependsOn,expiration:null==a?void 0:a.expiration,chainTag:null==a?void 0:a.chainTag,blockRef:null==a?void 0:a.blockRef,delegationUrl:null==a?void 0:a.delegationUrl,comment:null==a?void 0:a.comment});return{id:n,wait:async()=>await this.waitForTransaction(n)}}async getLegacyBaseGasPrice(){return await this.executeCall(I.PARAMS_ADDRESS,s.ro.ofAbi(I.PARAMS_ABI).getFunction("get"),[s.ky.encodeBytes32String("base-gas-price","left")])}getContractCallResult(e,t,a){var n;if(a)return{success:!1,result:{errorMessage:null!==(n=ed(e))&&void 0!==n?n:""}};let i=s._h.of(e);return{success:!0,result:{plain:t.decodeResult(i),array:t.decodeOutputAsArray(i)}}}constructor(e,t,a,n,i){this.blocksModule=e,this.debugModule=t,this.logsModule=a,this.gasModule=n,this.forkDetector=i}},eh=async(e,t,a,n)=>{let i=s._h.of(e.encoded).toString();try{let e=await n.http("POST",t,{body:{origin:a,raw:i},headers:{"Content-Type":"application/json"}});return s.MI.of(e.signature.slice(2)).bytes}catch(e){throw new r.vR("_getDelegationSignature()","Delegation failed: Cannot get signature from gasPayerUrl.",{gasPayerUrl:t},e)}},eg=e=>{let t=null==e,a=!t&&(null==e?void 0:e.gasPayerServiceUrl)!==void 0,n=!t&&(null==e?void 0:e.gasPayerPrivateKey)!==void 0;return{isDelegated:()=>a||n,gasPayerOrUndefined:()=>t?void 0:e,gasPayerOrNull:()=>t?null:e,getDelegationSignatureUsingUrl:async(t,n,i)=>{if(!a)throw new r.vR("DelegationHandler.getDelegationSignatureUsingUrl()","Delegation with url failed: gasPayerServiceUrl is not defined.",void 0);return await eh(t,null==e?void 0:e.gasPayerServiceUrl,n,i)}}},ep=new Map,em=!1,ey=class{async isGalacticaForked(e){if(em)return!0;if(null!=e||(e="best"),!s.AT.isValid(e))throw new r.I9("GalacticaForkDetector.isGalacticaForked()","Invalid revision. Must be a valid block number or ID.",{revision:e});let t=String(e),a=ep.get(t),n=Date.now();if(void 0!==a){if(a.result)return em=!0,!0;if(n-a.timestamp<3e5)return!1}let i=await this.httpClient.http("GET",V.blocks.get.BLOCK_DETAIL(e),{query:F({expanded:!0})});if(null===i)return ep.set(t,{result:!1,timestamp:n}),!1;let o=void 0!==i.baseFeePerGas;return ep.set(t,{result:o,timestamp:n}),o&&(em=!0),o}async detectGalactica(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"best";return await this.isGalacticaForked(e)}clearCache(){ep.clear(),em=!1}constructor(e){this.httpClient=e}},ev=class e{static at(t,a){return new e(new _(t),a)}destroy(){this.blocks.destroy()}static fromUrl(t,a){return e.at(t,a)}constructor(e,t){this.httpClient=e,this.accounts=new K(e),this.debug=new en(e),this.blocks=new z(e,t),this.logs=new eo(this.blocks),this.nodes=new es(this.blocks),this.gas=new ei(this.httpClient),this.forkDetector=new ey(this.httpClient),this.transactions=new eu(this.blocks,this.debug,this.logs,this.gas,this.forkDetector),this.gas.setTransactionsModule(this.transactions),this.contracts=new ea(this.transactions)}},ef=class{async populateCall(e){if(void 0===e.from||null===e.from)e.from=s.pV.checksum(s.MI.of(await this.getAddress()));else if(s.pV.checksum(s.MI.of(e.from))!==s.pV.checksum(s.MI.of(await this.getAddress())))throw new r.I9("VeChainAbstractSigner.populateCall()","From address does not match the signer address.",{signerAddress:s.pV.checksum(s.MI.of(await this.getAddress())),fromAddress:s.pV.checksum(s.MI.of(e.from))});return void 0===e.to&&(e.to=null),void 0!==e.clauses&&e.clauses.length>0&&(e.to=e.clauses[0].to,e.value=e.clauses[0].value,e.data=e.clauses[0].data),e}async populateTransaction(e){var t,a,n,i,o,s,l,c,d;if(void 0===this.provider)throw new r.BP("VechainAbstractSigner.populateTransaction()","Thor client not found into the signer. Please attach a Provider with a thor client to your signer instance.",{provider:this.provider});let u=this.provider.thorClient,h=await this.populateCall(e),g;return void 0!==e.gasLimit?(console.warn("\n****************** WARNING: Deprecated Property Usage ******************\n- The `gasLimit` property is deprecated and will be removed in a future release.\n- Please use the `gas` property instead.\n- The `gasLimit` value will be used as the `gas` value for this transaction.\n"),g=Number(e.gasLimit)):g=void 0!==e.gas?Number(e.gas):await this.estimateGas(e),await u.transactions.buildTransactionBody(null!==(a=h.clauses)&&void 0!==a?a:this._buildClauses(h),g,{isDelegated:null===(t=this.provider)||void 0===t?void 0:t.enableDelegation,nonce:null!==(n=h.nonce)&&void 0!==n?n:await this.getNonce("pending"),blockRef:null!==(i=h.blockRef)&&void 0!==i?i:void 0,chainTag:null!==(o=h.chainTag)&&void 0!==o?o:void 0,dependsOn:null!==(s=h.dependsOn)&&void 0!==s?s:void 0,expiration:h.expiration,gasPriceCoef:null!==(l=h.gasPriceCoef)&&void 0!==l?l:void 0,maxPriorityFeePerGas:null!==(c=h.maxPriorityFeePerGas)&&void 0!==c?c:void 0,maxFeePerGas:null!==(d=h.maxFeePerGas)&&void 0!==d?d:void 0,gas:e.gas,gasLimit:e.gasLimit})}async estimateGas(e){var t;if(void 0===this.provider)throw new r.BP("VechainAbstractSigner.estimateGas()","Thor client not found into the signer. Please attach a Provider with a thor client to your signer instance.",{provider:this.provider});let a=this.provider.thorClient,n=await this.populateCall(e);return(await a.transactions.estimateGas(null!==(t=n.clauses)&&void 0!==t?t:this._buildClauses(n),n.from)).totalGas}async call(e,t){var a,n,i,o,s,l,c;if(void 0===this.provider)throw new r.BP("VechainAbstractSigner.call()","Thor client not found into the signer. Please attach a Provider with a thor client to your signer instance.",{provider:this.provider});let d=this.provider.thorClient,u=await this.populateCall(e);return(await d.transactions.simulateTransaction(null!==(a=u.clauses)&&void 0!==a?a:this._buildClauses(u),{revision:null!=t?t:void 0,gas:null!==(n=u.gas)&&void 0!==n?n:void 0,gasPrice:null!==(i=u.gasPrice)&&void 0!==i?i:void 0,caller:u.from,provedWork:null!==(o=u.provedWork)&&void 0!==o?o:void 0,gasPayer:null!==(s=u.gasPayer)&&void 0!==s?s:void 0,expiration:null!==(l=u.expiration)&&void 0!==l?l:void 0,blockRef:null!==(c=u.blockRef)&&void 0!==c?c:void 0}))[0].data}async getNonce(e){return void 0!==this.provider?await this.provider.request({method:"eth_getTransactionCount",params:[await this.getAddress(),e]}):s._h.random(6).toString()}async signMessage(e){try{let t="string"==typeof e?s.Dy.of(e).bytes:e,a=s.gN.of((0,h.Id)(this.MESSAGE_PREFIX,s.Dy.of(t.length).bytes,t)).bytes;return await this.signPayload(a)}catch(t){throw new r.s$("VeChainAbstractSigner.signMessage","The message could not be signed.",{message:e},t)}}deducePrimaryType(e){let t=new Map;for(let n in Object.keys(e).forEach(e=>{t.set(e,[])}),e)for(let i of e[n]){var a;let e=i.type.split("[")[0];t.has(e)&&(null===(a=t.get(e))||void 0===a||a.push(n))}let n=Array.from(t.keys()).filter(e=>{var a;return(null===(a=t.get(e))||void 0===a?void 0:a.length)===0});if(1!==n.length)throw new r.s$("VeChainAbstractSigner.deducePrimaryType","Ambiguous primary types or unused types.",{primaryTypes:n.join(", ")});return n[0]}async signTypedData(e,t,a,n){try{let i={chainId:void 0,name:e.name,salt:e.salt,verifyingContract:e.verifyingContract,version:e.version};if(void 0!==e.chainId){if("string"==typeof e.chainId||"number"==typeof e.chainId)i.chainId=BigInt(e.chainId);else if("bigint"==typeof e.chainId)i.chainId=e.chainId;else throw new r.I9("VeChainAbstractSigner.signTypedData","Invalid chainId type.",{chainId:e.chainId})}let o=s._h.of((0,g.Zh)({domain:i,types:t,primaryType:null!=n?n:this.deducePrimaryType(t),message:a})).bytes;return await this.signPayload(o)}catch(i){throw new r.s$("VeChainAbstractSigner.signTypedData","The typed data could not be signed.",{domain:e,types:t,message:a,primaryType:n},i)}}async resolveName(e){return void 0===this.provider?null:await W.resolveName(this.provider.thorClient,e)}_buildClauses(e){var t,a,n;return void 0!==e.to&&null!==e.to?[{to:e.to,data:null!==(t=e.data)&&void 0!==t?t:"0x",value:null!==(a=e.value)&&void 0!==a?a:"0x0"}]:[s.y4.deployContract(s.MI.of(null!==(n=e.data)&&void 0!==n?n:0),void 0,{value:void 0===e.value?e.value:s.MI.of(e.value).toString(!0),comment:e.comment})]}constructor(e){this.MESSAGE_PREFIX=s.Dy.of("\x19Ethereum Signed Message:\n").bytes,this.provider=e}},ew=class e extends ef{connect(t){return new e(this.privateKey,t)}async getAddress(){return s.pV.checksum(s.MI.of(await Promise.resolve(s.pV.ofPrivateKey(this.privateKey).toString())))}async signTransaction(e){var t;if(void 0===this.provider)throw new r.BP("VeChainPrivateKeySigner.signTransaction()","Thor provider is not found into the signer. Please attach a Provider to your signer instance.",{transactionToSign:e});let a=eg(await (null===(t=this.provider.wallet)||void 0===t?void 0:t.getGasPayer())).gasPayerOrNull();return void 0!==e.delegationUrl&&(a={gasPayerServiceUrl:e.delegationUrl}),await this._signFlow(e,a,this.provider.thorClient)}async sendTransaction(e){if(void 0===this.provider)throw new r.BP("VeChainPrivateKeySigner.sendTransaction()","Thor provider is not found into the signer. Please attach a Provider to your signer instance.",{transactionToSend:e});let t=this.provider,a=await this.signTransaction(e);return await t.request({method:"eth_sendRawTransaction",params:[a]})}async signPayload(e){let t=s.CD.sign(e,new Uint8Array(this.privateKey));return t[t.length-1]+=27,await Promise.resolve(s._h.of(t).toString())}async _signFlow(e,t,a){let n=await this.populateTransaction(e);return null!==t?await this._signWithGasPayer(n,this.privateKey,a,t):s._h.of(s.ZX.of(n).sign(this.privateKey).encoded).toString()}async _signWithGasPayer(e,t,a,n){let i=s.pV.ofPrivateKey(t).toString(),o=s.ZX.of(e);if((null==n?void 0:n.gasPayerPrivateKey)!==void 0){if(!s.MI.isValid(n.gasPayerPrivateKey))throw new r.I9("VeChainPrivateKeySigner._signWithGasPayer","Invalid gas payer private key. Ensure it is a valid hexadecimal string.",{gasPayerPrivateKey:n.gasPayerPrivateKey});return s._h.of(s.ZX.of(e).signAsSenderAndGasPayer(t,s.MI.of(n.gasPayerPrivateKey).bytes).encoded).toString()}let l=await eg(n).getDelegationSignatureUsingUrl(o,i,a.httpClient),c=s.CD.sign(o.getTransactionHash().bytes,t),d=new Uint8Array(c.length+l.length);return d.set(c),d.set(l,c.length),s._h.of(s.ZX.of(o.body,d).encoded).toString()}constructor(e,t){if(!s.CD.isValidPrivateKey(e))throw new r.Ch("VeChainPrivateKeySigner.constructor()","Invalid private key used to sign initialize the signer. Ensure it's a valid Secp256k1 private key.",void 0);super(t),this.privateKey=e}},eb=class{getSignerSync(e,t){let a=this.getAccountSync(t);return(null==a?void 0:a.privateKey)!==void 0?new ew(a.privateKey,e):null}getAddressesSync(){return this.accounts.map(e=>e.address)}getAccountSync(e){var t,a;if(void 0===e||"number"==typeof e)return null!==(t=this.accounts[null!=e?e:0])&&void 0!==t?t:null;if(!s.pV.isValid(e))throw new r.I9("AbstractProviderInternalWallet.getAccountSync()","Invalid params expected an address.",{addressOrIndex:e});return null!==(a=this.accounts.find(t=>s.pV.checksum(s.MI.of(t.address))===s.pV.checksum(s.MI.of(e))))&&void 0!==a?a:null}getGasPayerSync(){return eg(this.gasPayer).gasPayerOrNull()}constructor(e,t){this.accounts=e,this.gasPayer=null==t?void 0:t.gasPayer}},eT=class extends eb{async getSigner(e,t){return await Promise.resolve(this.getSignerSync(e,t))}async getAddresses(){return await Promise.resolve(this.getAddressesSync())}async getAccount(e){return await Promise.resolve(this.getAccountSync(e))}async getGasPayer(){return await Promise.resolve(this.getGasPayerSync())}},e_=class extends eT{constructor(e,t=1,a=0,n=s.cf.VET_DERIVATION_PATH,i){super([...Array(t).keys()].map(t=>{let i=s.cf.fromMnemonic(e,n).deriveChild(t+a).privateKey;return{privateKey:i,publicKey:s.CD.derivePublicKey(i),address:s.pV.ofPrivateKey(i).toString()}}),i),this.mnemonic=e,this.derivationPath=n,this.count=t,this.initialIndex=a}},eP=class extends u.R${async send(e,t){return this._start(),await super.send(e,t)}async _send(e){let t=Array.isArray(e)?e:[e],a=[];for(let e of t)try{let t=await this.hardhatProvider.send(e.method,e.params);a.push({id:e.id,result:t})}catch(t){a.push({id:e.id,error:{code:-32603,message:(0,r.Gr)(t)}})}return a}constructor(e,t,a){super({name:t,chainId:e}),this.hardhatProvider=a}},eB=5e3,ek=["latest","earliest","pending","safe","finalized"],eI=e=>{if(s.MI.isValid(e))return s.AT.of(s.MI.of(e).n.toString());if(!ek.includes(e)){let t=e.toString();throw new r.ZH("DefaultBlockToRevision","Invalid default block: ".concat(t),t,null)}return"earliest"===e?s.AT.of(s.MI.of(0)):"safe"===e?s.AT.of("justified"):"finalized"===e?s.AT.of("finalized"):s.AT.of("best")},eC={MAINNET:"0x186a9",TESTNET:"0x186aa",SOLO_DEFAULT:"0xf6"},ex={MAINNET:"0x4a",TESTNET:"0x27",SOLO_DEFAULT:"0xf6"},eS=e=>e.isEqual(s.MI.of(ex.MAINNET))?s.MI.of(eC.MAINNET):e.isEqual(s.MI.of(ex.TESTNET))?s.MI.of(eC.TESTNET):e.isEqual(s.MI.of(ex.SOLO_DEFAULT))?s.MI.of(eC.SOLO_DEFAULT):e,eM=(e,t)=>{let a="string"==typeof e.transactions[0]?e.transactions.findIndex(e=>e===t):e.transactions.findIndex(e=>e.hash===t);if(-1===a)throw new r.I9("getTransactionIndexIntoBlock()","Transaction not found in block.",{block:e,hash:t});return a},eE=(e,t,a)=>{let n=eM(eN.formatToRPCStandard(e,a),t),i=0;for(let t=0;t<n;t++)for(let a of e.transactions[t].outputs)i+=a.events.length;return i},eA=e=>null==e||"number"!=typeof e?"0x0":e===(0,s.LA)(s.D_.EIP1559)?"0x2":"0x0",eR=(e,t,a,n,i)=>{var o,r,l,c,d;let u="type"in e?e.type:0;return{blockHash:t,blockNumber:s.Q1.of(a).toString(),from:e.origin,gas:s.Q1.of(s.MI.of(e.gas).bi).toString(),chainId:n,hash:e.id,nonce:e.nonce,transactionIndex:s.Q1.of(i).toString(),input:null!==(c=null===(o=e.clauses[0])||void 0===o?void 0:o.data)&&void 0!==c?c:"",to:null!==(d=null===(r=e.clauses[0])||void 0===r?void 0:r.to)&&void 0!==d?d:null,value:(null===(l=e.clauses[0])||void 0===l?void 0:l.value)!==void 0?s.Q1.of(s.MI.of(e.clauses[0].value).bi).toString():"",type:eA(u),maxFeePerGas:void 0!==e.maxFeePerGas&&null!==e.maxFeePerGas?s.Q1.of(s.MI.of(e.maxFeePerGas).bi).toString():void 0,maxPriorityFeePerGas:void 0!==e.maxPriorityFeePerGas&&null!==e.maxPriorityFeePerGas?s.Q1.of(s.MI.of(e.maxPriorityFeePerGas).bi).toString():void 0,gasPrice:"0x0",v:"0x0",r:"0x0",s:"0x0",accessList:[],yParity:"0x0"}},eG={formatToRPCStandard:(e,t,a)=>eR(e,e.meta.blockID,e.meta.blockNumber,t,a),formatExpandedBlockToRPCStandard:(e,t,a,n)=>eR(e,t.id,t.number,n,a),formatTransactionReceiptToRPCStandard:function(e,t,a,n,i){let o=eM(eN.formatToRPCStandard(n,i),e),r=eE(n,e,i),l=[],c=r;t.outputs.forEach(e=>{e.events.forEach(e=>{l.push({blockHash:t.meta.blockID,blockNumber:s.Q1.of(t.meta.blockNumber).toString(),transactionHash:t.meta.txID,address:e.address,topics:e.topics.map(e=>e),data:e.data,removed:!1,transactionIndex:s.Q1.of(o).toString(),logIndex:s.Q1.of(c).toString()}),c++})});let d="type"in a?a.type:0;return{blockHash:t.meta.blockID,blockNumber:s.Q1.of(t.meta.blockNumber).toString(),contractAddress:t.outputs.length>0?t.outputs[0].contractAddress:null,from:a.origin,gasUsed:s.Q1.of(t.gasUsed).toString(),logs:l,status:t.reverted?"0x0":"0x1",to:a.clauses[0].to,transactionHash:t.meta.txID,transactionIndex:s.Q1.of(o).toString(),logsBloom:s._h.of((0,s.JZ)(256)).toString(),cumulativeGasUsed:"0x0",effectiveGasPrice:"0x0",type:eA(d)}}},eN={formatToRPCStandard:(e,t)=>{let a="string"==typeof e.transactions[0]?e.transactions:e.transactions.map((a,n)=>eG.formatExpandedBlockToRPCStandard(a,e,n,t));return{hash:e.id,parentHash:e.parentID,number:s.Q1.of(e.number).toString(),size:s.Q1.of(e.size).toString(),stateRoot:e.stateRoot,receiptsRoot:e.receiptsRoot,transactionsRoot:e.txsRoot,timestamp:s.Q1.of(e.timestamp).toString(),gasLimit:s.Q1.of(e.gasLimit).toString(),gasUsed:s.Q1.of(e.gasUsed).toString(),transactions:a,miner:e.beneficiary,baseFeePerGas:e.baseFeePerGas,difficulty:"0x0",totalDifficulty:"0x0",uncles:[],sha3Uncles:s.MI.of((0,s.JZ)(32)).toString(),nonce:s.MI.of((0,s.JZ)(8)).toString(),logsBloom:s.MI.of((0,s.JZ)(256)).toString(),extraData:"0x",...void 0!==e.baseFeePerGas?{baseFeePerGas:e.baseFeePerGas}:{},mixHash:s.MI.of((0,s.JZ)(32)).toString()}}};function eF(e,t){return"call"===e?{...t,revertReason:""}:Object.fromEntries(Object.entries(t).map(e=>{let[t,a]=e;return[t,{balance:a.balance,code:a.code,storage:a.storage,nonce:0}]}))}var eD={formatToRPCStandard:eF},eL=e=>e.map(e=>({address:e.address,blockHash:e.meta.blockID,blockNumber:s.fo.of(e.meta.blockNumber).toString(),data:e.data,logIndex:"0x0",removed:!1,topics:e.topics,transactionHash:e.meta.txID,transactionIndex:"0x0"})),eU=(e,t)=>{var a,n,i,o,r;return{address:t,topic0:null!==(a=e[0])&&void 0!==a?a:void 0,topic1:null!==(n=e[1])&&void 0!==n?n:void 0,topic2:null!==(i=e[2])&&void 0!==i?i:void 0,topic3:null!==(o=e[3])&&void 0!==o?o:void 0,topic4:null!==(r=e[4])&&void 0!==r?r:void 0}},eO=e=>{let t=[];return(void 0!==e.address?"string"==typeof e.address?[e.address]:e.address:[void 0]).map(t=>{var a;return eH(t,null!==(a=e.topics)&&void 0!==a?a:[])}).flat()},eH=(e,t)=>{let a=[],n=[];t.forEach(e=>{Array.isArray(e)||a.push(e),Array.isArray(e)&&n.push(e)});let i=[];return a.length>0&&i.push(eU(a,e)),n.forEach(t=>{t.forEach(t=>{i.push({address:e,topic0:t,topic1:void 0,topic2:void 0,topic3:void 0,topic4:void 0})})}),0===i.length&&i.push({address:e,topic0:void 0,topic1:void 0,topic2:void 0,topic3:void 0,topic4:void 0}),i},eV=null,ej=null,eq=null,eW=async e=>{try{if(null!==eV)return eV.toString();let t=await e.blocks.getGenesisBlock();if((null==t?void 0:t.id)===null||(null==t?void 0:t.id)===void 0)throw new r.BP("eth_chainId()","The genesis block id is null or undefined. Unable to get the chain id.",{url:e.httpClient.baseURL});if(!s._h.isValid(t.id))throw new r.BP("eth_chainId()","The genesis block id is invalid. Unable to get the chain id.",{url:e.httpClient.baseURL});return eq=s._h.of(t.id),ej=s.MI.of(eq.bytes.slice(-1)),(eV=eS(ej)).toString()}catch(t){throw new r.pt("eth_chainId()",'Method "eth_chainId" failed.',{url:e.httpClient.baseURL,innerError:(0,r.Gr)(t)})}},eK=async e=>null!==eV?eV.toString():await eW(e),ez=async e=>null!==ej?ej.toString():await eW(e),eQ=async(e,t)=>{if(1!==t.length||"string"!=typeof t[0])throw new r.BP("eth_getTransactionReceipt",'Invalid input params for "eth_getTransactionReceipt" method. See '.concat(N," for details."),{params:t});if(!s.lM.isValid(t[0]))throw new r.BP("eth_getTransactionReceipt","Invalid transaction ID given as input. Input must be an hex string of length 64.",{params:t});try{let[a]=t,n=await e.transactions.getTransactionReceipt(a);if(null===n)return null;{let t=await e.blocks.getBlockExpanded(n.meta.blockID),i=await e.transactions.getTransaction(a),o=await eW(e);return null!==i?eG.formatTransactionReceiptToRPCStandard(a,n,i,t,o):null}}catch(a){throw new r.pt("eth_getTransactionReceipt()",'Method "eth_getTransactionReceipt" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},eJ=async(e,t)=>{if(2!==t.length||"string"!=typeof t[0]||"object"!=typeof t[1])throw new r.BP("debug_traceTransaction",'Invalid input params for "debug_traceTransaction" method. See '.concat(N," for details."),{params:t});let[a,n]=t;if(!s.lM.isValid(a))throw new r.I9("debug_traceTransaction()","Invalid transaction ID given as input. Input must be an hex string of length 64.",{transactionId:a});let i="callTracer"===n.tracer?"call":"prestate";try{let t=await eQ(e,[a]),n=await e.debug.traceTransactionClause({target:{blockId:s.lM.of(null==t?void 0:t.blockHash),transaction:s.lM.of(null==t?void 0:t.transactionHash),clauseIndex:0},config:{}},i);return eD.formatToRPCStandard(i,n)}catch(a){throw new r.pt("debug_traceTransaction()",'Method "debug_traceTransaction" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},eY=async(e,t)=>{if(2!==t.length||"string"!=typeof t[0]||!s.lM.isValid(t[0])||"boolean"!=typeof t[1])throw new r.BP("eth_getBlockByHash",'Invalid input params for "eth_getBlockByHash" method. See '.concat(N," for details."),{params:t});try{let[a,n]=t,i="0x0";n&&(i=await eW(e));let o=n?await e.blocks.getBlockExpanded(a):await e.blocks.getBlockCompressed(a);return null!==o?eN.formatToRPCStandard(o,i):null}catch(a){throw new r.pt("eth_getBlockByHash()",'Method "eth_getBlockByHash" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},eZ=async(e,t)=>{if(2!==t.length||"string"!=typeof t[0]||!s.lM.isValid(t[0])||"object"!=typeof t[1])throw new r.BP("debug_traceBlockByHash",'Invalid input params for "debug_traceBlockByHash" method. See https://www.quicknode.com/docs/ethereum/debug_traceBlockByHash for details.',{params:t});let[a,n]=t;try{let t=await eY(e,[a,!1]);if(null===t)return[];let i=[];for(let a of t.transactions){let t=await eJ(e,[a,{...n,timeout:"5s"}]);i.push({txHash:a,result:t})}return i}catch(a){throw new r.pt("debug_traceBlockByHash()",'Method "debug_traceBlockByHash" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},eX=async(e,t)=>{if(2!==t.length||"string"!=typeof t[0]||"boolean"!=typeof t[1])throw new r.BP("eth_getBlockByNumber",'Invalid input params for "eth_getBlockByNumber" method. See '.concat(N," for details."),{params:t});try{let[a,n]=t,i=eI(a),o="0x0";n&&(o=await eW(e));let r=n?await e.blocks.getBlockExpanded(i.toString()):await e.blocks.getBlockCompressed(i.toString());return null!==r?eN.formatToRPCStandard(r,o):null}catch(a){throw new r.pt("eth_getBlockByNumber()",'Method "eth_getBlockByNumber" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},e$=async(e,t)=>{if(2!==t.length||"string"!=typeof t[0]||"object"!=typeof t[1])throw new r.BP("debug_traceBlockByNumber",'Invalid input params for "debug_traceBlockByNumber" method. See https://www.quicknode.com/docs/ethereum/debug_traceBlockByNumber for details.',{params:t});let[a,n]=t;try{let t=await eX(e,[a,!1]);if(null===t)return[];let i=[];for(let a of t.transactions){let t=await eJ(e,[a,{...n,timeout:"5s"}]);i.push({txHash:a,result:t})}return i}catch(a){throw new r.pt("debug_traceBlockByNumber()",'Method "debug_traceBlockByNumber" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},e0=async(e,t)=>{if(3!==t.length||"object"!=typeof t[0]||"string"!=typeof t[1]||"object"!=typeof t[2])throw new r.BP("debug_traceCall",'Invalid input params for "debug_traceCall" method. See '.concat(N," for details."),{params:t});let a=t[0],n=t[2],i="callTracer"===n.tracer?"call":"prestate";try{let t=await e.debug.traceContractCall({options:{caller:a.from,gas:void 0!==a.gas?parseInt(a.gas,16):void 0,gasPrice:a.gasPrice},target:{to:"string"==typeof a.to?s.pV.of(a.to):a.to,data:"string"==typeof a.data?s.MI.of(a.data):void 0},config:n.tracerConfig},i);return eD.formatToRPCStandard(i,t)}catch(a){throw new r.pt("debug_traceCall()",'Method "debug_traceCall" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},e1=async()=>((0,p.B)("warning").log({title:"engine_getPayloadBodiesByHashV1",messages:['Method "engine_getPayloadBodiesByHashV1" has not been implemented yet.']}),await Promise.resolve("METHOD NOT IMPLEMENTED")),e2=async()=>((0,p.B)("warning").log({title:"engine_getPayloadBodiesByRangeV1",messages:['Method "engine_getPayloadBodiesByRangeV1" has not been implemented yet.']}),await Promise.resolve("METHOD NOT IMPLEMENTED")),e3=async e=>(null==e?void 0:e.wallet)!==void 0?await (null==e?void 0:e.wallet.getAddresses()):[],e4=async e=>{try{let t=await e.blocks.getBestBlockCompressed();return(null==t?void 0:t.number)!==void 0?"0x".concat(t.number.toString(16)):"0x0"}catch(t){throw new r.pt("eth_blockNumber()",'Method "eth_blockNumber" failed.',{url:e.httpClient.baseURL,innerError:(0,r.Gr)(t)})}},e6=async(e,t)=>{if(2!==t.length||"object"!=typeof t[0]||"object"!=typeof t[1]&&"string"!=typeof t[1])throw new r.BP("eth_call",'Invalid input params for "eth_call" method. See '.concat(N," for details."),{params:t});try{var a,n,i,o;let[s,l]=t,c=await e.transactions.simulateTransaction([{to:null!==(a=s.to)&&void 0!==a?a:null,value:null!==(n=s.value)&&void 0!==n?n:"0x0",data:null!==(i=s.data)&&void 0!==i?i:"0x0"}],{revision:eI(l),gas:void 0!==s.gas?parseInt(s.gas,16):void 0,gasPrice:null!==(o=s.gasPrice)&&void 0!==o?o:s.gasPrice,caller:s.from});if(c[0].reverted)throw new r.Kx(c[0].vmError,c[0].data);return c[0].data}catch(a){throw a instanceof r.pt||a instanceof r.Kx?a:a instanceof r.z3?new r.pt("eth_call()",'Method "eth_call" failed due to network communication error.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,networkError:!0,networkErrorType:a.data.networkErrorType,innerError:(0,r.Gr)(a)}):new r.pt("eth_call()",'Method "eth_call" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},e9=async(e,t)=>{if(t.length<1||t.length>2||"object"!=typeof t[0])throw new r.BP("eth_estimateGas",'Invalid input params for "eth_estimateGas" method. See '.concat(N," for details."),{params:t});try{var a,n,i,o,l,c,d,u;1===t.length&&t.push("latest");let[h,g]=t,p=eI(g),m=await e.transactions.estimateGas([{to:null!==(a=h.to)&&void 0!==a?a:null,value:null!==(n=h.value)&&void 0!==n?n:"0x0",data:null!==(i=h.data)&&void 0!==i?i:"0x"}],h.from,{revision:p});if(m.reverted){let t=await e.transactions.simulateTransaction([{to:null!==(o=h.to)&&void 0!==o?o:null,value:null!==(l=h.value)&&void 0!==l?l:"0x0",data:null!==(c=h.data)&&void 0!==c?c:"0x"}],{revision:p,caller:h.from}),a=null!==(u=null!==(d=m.revertReasons.find(e=>""!==e))&&void 0!==d?d:m.vmErrors.find(e=>""!==e))&&void 0!==u?u:"execution reverted",n=t[0].data||"0x";throw n.startsWith("0x")||(n="0x"+n),new r.Kx(a.toString(),n)}return s.MI.of(m.totalGas).toString(!0)}catch(a){throw a instanceof r.Kx?a:a instanceof r.z3?new r.pt("eth_estimateGas()",'Method "eth_estimateGas" failed due to network communication error.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,networkError:!0,networkErrorType:a.data.networkErrorType,innerError:(0,r.Gr)(a)}):new r.pt("eth_estimateGas()",'Method "eth_estimateGas" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},e5=async(e,t,a)=>{if(!Array.isArray(t)||t.length<2)throw new r.BP("eth_feeHistory",'Invalid input params for "eth_feeHistory" method.',{params:t});if(!await e.forkDetector.detectGalactica())throw new r.wr("eth_feeHistory",'Method "eth_feeHistory" is not available before Galactica hardfork.',{url:e.httpClient.baseURL});let n=t[0],i=t[1],o=t[2];if("string"!=typeof i&&"number"!=typeof i)throw new r.BP("eth_feeHistory","Invalid newestBlock parameter. Must be a string or number.",{newestBlock:i});let s=Number(n);if(!Number.isFinite(s)||s<=0)throw new r.BP("eth_feeHistory","blockCount must be a positive finite number.",{blockCount:n,blockCountNum:s});let l=eI(i);try{return await e.gas.getFeeHistory({blockCount:s,newestBlock:l.toString(),rewardPercentiles:o})}catch(t){throw t instanceof r.BP?t:new r.pt("eth_feeHistory()",'Method "eth_feeHistory" failed.',{url:e.httpClient.baseURL,innerError:(0,r.Gr)(t)})}},e8=async e=>{if(!await e.forkDetector.detectGalactica()){let{result:{plain:t}}=await e.contracts.getLegacyBaseGasPrice();return s.MI.of(t).toString(!0)}let t=await e.blocks.getBestBlockCompressed(),a=null==t?void 0:t.baseFeePerGas;if(void 0===a)throw new r.pt("eth_gasPrice","Last block should have baseFeePerGas defined.",{params:t,url:e.httpClient.baseURL});let n=await e.gas.getMaxPriorityFeePerGas(),i=s.MI.of(a).bi,o=s.MI.of(n).bi;return s.MI.of(i+o).toString(!0)},e7=async(e,t)=>{if(2!==t.length||"string"!=typeof t[0]||"object"!=typeof t[1]&&"string"!=typeof t[1])throw new r.BP("eth_getBalance",'Invalid input params for "eth_getBalance" method. See '.concat(N," for details."),{params:t});try{let[a,n]=t;return(await e.accounts.getAccount(s.pV.of(a),{revision:eI(n)})).balance}catch(a){throw new r.pt("eth_getBalance()",'Method "eth_getBalance" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},te=async(e,t)=>{if(1!==t.length||"string"!=typeof t[0])throw new r.BP("eth_getBlockReceipts",'Invalid input params for "eth_getBlockReceipts" method. See '.concat(N," for details."),{params:t});try{let[a]=t,n=null;if(n=s.MI.isValid(a)&&66===a.length?await eY(e,[a,!0]):await eX(e,[a,!0]),null===n)return null;let i=n.transactions,o=[];for(let t of i){let a=await eQ(e,[t.hash]);o.push(a)}return o}catch(a){throw new r.pt("eth_getBlockReceipts()",'Method "eth_getBlockReceipts" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},tt=async(e,t)=>{if(1!==t.length||"string"!=typeof t[0]||!s.lM.isValid(t[0]))throw new r.BP("eth_getBlockTransactionCountByHash",'Invalid input params for "eth_getBlockTransactionCountByHash" method. See '.concat(N," for details."),{params:t});let a=await eY(e,[t[0],!1]);return null!==a?a.transactions.length:0},ta=async(e,t)=>{if(1!==t.length||"string"!=typeof t[0])throw new r.BP("eth_getBlockTransactionCountByNumber",'Invalid input params for "eth_getBlockTransactionCountByNumber" method. See '.concat(N," for details."),{params:t});let a=await eX(e,[t[0],!0]);return null!==a?a.transactions.length:0},tn=async(e,t)=>{if(2!==t.length||"string"!=typeof t[0]||"object"!=typeof t[1]&&"string"!=typeof t[1])throw new r.BP("eth_getCode",'Invalid input params for "eth_getCode" method. See '.concat(N," for details."),{params:t});try{let[a,n]=t;return(await e.accounts.getBytecode(s.pV.of(a),{revision:eI(n)})).toString()}catch(a){throw new r.pt("eth_getCode()",'Method "eth_getCode" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},ti=async()=>((0,p.B)("warning").log({title:"eth_getFilterChanges",messages:['Method "eth_getFilterChanges" has not been implemented yet.']}),await Promise.resolve("METHOD NOT IMPLEMENTED")),to=async()=>((0,p.B)("warning").log({title:"eth_getFilterLogs",messages:['Method "eth_getFilterLogs" has not been implemented yet.']}),await Promise.resolve("METHOD NOT IMPLEMENTED")),tr=async(e,t)=>{if(1!==t.length||"object"!=typeof t[0])throw new r.BP("eth_getLogs",'Invalid input params for "eth_getLogs" method. See '.concat(N," for details."),{params:t});let[a]=t;try{let t=await e.blocks.getBestBlockCompressed(),n=eO({address:null!==a.address?a.address:void 0,topics:a.topics}),i=await e.logs.filterRawEventLogs({range:{unit:"block",from:void 0!==a.fromBlock?parseInt(a.fromBlock,16):t.number,to:void 0!==a.toBlock?parseInt(a.toBlock,16):t.number},criteriaSet:n,order:"asc",options:{offset:0,limit:1e3}});return eL(i)}catch(a){throw new r.pt("eth_getLogs()",'Method "eth_getLogs" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},ts=async(e,t)=>{if(3!==t.length||"string"!=typeof t[0]||"string"!=typeof t[1]&&"bigint"!=typeof t[1]||null!=t[2]&&"object"!=typeof t[2]&&"string"!=typeof t[2])throw new r.BP("eth_getStorageAt",'Invalid input params for "eth_getStorageAt" method. See '.concat(N," for details."),{params:t});try{var a;null!==(a=t[2])&&void 0!==a||(t[2]="latest");let[n,i,o]=t;return(await e.accounts.getStorageAt(s.pV.of(n),s.lM.of(i),{revision:eI(o)})).toString()}catch(a){throw new r.pt("eth_getStorageAt()",'Method "eth_getStorageAt" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},tl=async(e,t)=>{if(1!==t.length||"string"!=typeof t[0])throw new r.BP("eth_getTransactionByHash",'Invalid input params for "eth_getTransactionByHash" method. See '.concat(N," for details."),{params:t});try{let[a]=t,n=await e.transactions.getTransaction(a);if(null===n)return null;let i=await eY(e,[n.meta.blockID,!1]);if(null===i)return null;let o=eM(i,a),r=await eW(e);return eG.formatToRPCStandard(n,r,o)}catch(a){throw new r.pt("eth_getTransactionByHash()",'Method "eth_getTransactionByHash" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},tc=async(e,t)=>{if(2!==t.length||"string"!=typeof t[0]||"string"!=typeof t[1])throw new r.BP("eth_getTransactionByBlockHashAndIndex",'Invalid input params for "eth_getTransactionByBlockHashAndIndex" method. See '.concat(N," for details."),{params:t});try{let[a,n]=t;for(let t of(await eY(e,[a,!1])).transactions){let a=await tl(e,[t]);if(a.transactionIndex===n)return a}return null}catch(a){throw new r.pt("eth_getTransactionByBlockHashAndIndex()",'Method "eth_getTransactionByBlockHashAndIndex" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},td=async(e,t)=>{if(2!==t.length||"string"!=typeof t[0]||"string"!=typeof t[1])throw new r.BP("eth_getTransactionByBlockNumberAndIndex",'Invalid input params for "eth_getTransactionByBlockNumberAndIndex" method. See '.concat(N," for details."),{params:t});try{let[a,n]=t;for(let t of(await eX(e,[a,!1])).transactions){let a=await tl(e,[t]);if(a.transactionIndex===n)return a}return null}catch(a){throw new r.pt("eth_getTransactionByBlockNumberAndIndex()",'Method "eth_getTransactionByBlockNumberAndIndex" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,innerError:(0,r.Gr)(a)})}},tu=async e=>{if("string"!=typeof e[0]||"object"!=typeof e[1]&&"string"!=typeof e[1])throw new r.BP("eth_getTransactionCount",'Invalid input params for "eth_getTransactionCount" method. See '.concat(N," for details."),{params:e});if(!s.pV.isValid(e[0]))throw new r.BP("eth_getTransactionCount","Invalid address, expected a 20 bytes address string.",{params:e});return await Promise.resolve(s._h.of(s.CD.randomBytes(6)).toString())},th=async e=>{if(2!==e.length||"string"!=typeof e[0]||!s.lM.isValid(e[0])||"string"!=typeof e[1])throw new r.BP("eth_getUncleByBlockHashAndIndex",'Invalid input params for "eth_getUncleByBlockHashAndIndex" method. See https://docs.infura.io/api/networks/ethereum/json-rpc-methods/eth_getunclebyblockhashandindex for details.',{params:e});return await Promise.resolve(null)},tg=async e=>{if(2!==e.length||"string"!=typeof e[0]||"string"!=typeof e[1])throw new r.BP("eth_getUncleByBlockNumberAndIndex",'Invalid input params for "eth_getUncleByBlockNumberAndIndex" method. See https://docs.infura.io/api/networks/ethereum/json-rpc-methods/eth_getunclebyblocknumberandindex for details.',{params:e});return await Promise.resolve(null)},tp=async e=>{if(1!==e.length||"string"!=typeof e[0]||!s.lM.isValid(e[0]))throw new r.BP("eth_getUncleCountByBlockHash",'Invalid input params for "eth_getUncleCountByBlockHash" method. See '.concat(N," for details."),{params:e});return await Promise.resolve(0)},tm=async e=>{if(1!==e.length||"string"!=typeof e[0])throw new r.BP("eth_getUncleCountByBlockNumber",'Invalid input params for "eth_getUncleCountByBlockNumber" method. See '.concat(N," for details."),{params:e});return await Promise.resolve(0)},ty=async(e,t,a)=>{try{if(!await e.forkDetector.detectGalactica())throw new r.wr("eth_maxPriorityFeePerGas",'Method "eth_maxPriorityFeePerGas" is not available before Galactica hardfork.',{url:e.httpClient.baseURL});return await e.gas.getMaxPriorityFeePerGas()}catch(t){throw t instanceof r.pt||t instanceof r.wr?t:new r.pt("eth_maxPriorityFeePerGas()",'Method "eth_maxPriorityFeePerGas" failed.',{url:e.httpClient.baseURL,innerError:(0,r.Gr)(t)})}},tv=async e=>{let t=await e3(e);if(0===t.length)throw new r.BP("eth_requestAccounts()",'Method "eth_requestAccounts" failed.',{provider:(0,r.Gr)(e)});return t},tf=async(e,t)=>{if(1!==t.length||"string"!=typeof t[0])throw new r.BP("eth_sendRawTransaction()",'Invalid input params for "eth_sendRawTransaction" method. See '.concat(N," for details."),{params:t});if(!s._h.isValid0x(t[0]))throw new r.BP("eth_sendRawTransaction()","Invalid transaction encoded data given as input. Input must be a hex string.",{params:t});try{let[a]=t;return(await e.transactions.sendRawTransaction(a)).id}catch(a){throw new r.pt("eth_sendRawTransaction()",'Method "eth_sendRawTransaction" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL},a)}},tw=async(e,t,a)=>{if(void 0===t||1!==t.length||"object"!=typeof t[0])throw new r.BP("eth_sendTransaction",'Invalid input params for "eth_sendTransaction" method. See '.concat(N," for details."),{params:t});if((null==a?void 0:a.wallet)===void 0)throw new r.BP("eth_sendTransaction","Provider must be defined with a wallet. Ensure that the provider is defined and connected to the network.",{provider:a});if(void 0===t[0].from)throw new r.BP("eth_sendTransaction","From field is required in the transaction object.",{provider:a});void 0===t[0].value&&(t[0].value="0x0");let[n]=t,i=await eK(e);if(null!=n.chainId&&n.chainId!==i)throw new r.BP("eth_sendTransaction","ChainId in the transaction object does not match the chainId of the network. Expected: ".concat(i,", Received: ").concat(n.chainId),{chainId:n.chainId});try{return await (await a.getSigner(n.from)).sendTransaction(n)}catch(a){throw a instanceof r.z3?new r.pt("eth_sendTransaction()",'Method "eth_sendTransaction" failed due to network communication error.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL,networkError:!0,networkErrorType:a.data.networkErrorType},a):new r.pt("eth_sendTransaction()",'Method "eth_sendTransaction" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL},a)}},tb=async(e,t,a)=>{if(1!==t.length||"object"!=typeof t[0])throw new r.BP("eth_signTransaction",'Invalid input params for "eth_signTransaction" method. See '.concat(N," for details."),{params:t});if((null==a?void 0:a.wallet)===void 0)throw new r.BP("eth_signTransaction","Provider must be defined with a wallet. Ensure that the provider is defined and connected to the network.",{provider:a});if(void 0===t[0].from)throw new r.BP("eth_signTransaction","From field is required in the transaction object.",{provider:a});let[n]=t;try{return await (await a.getSigner(n.from)).signTransaction(n)}catch(a){throw new r.pt("eth_signTransaction()",'Method "eth_signTransaction" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL},a)}},tT=async(e,t,a)=>{if(2!==t.length||"string"!=typeof t[0]||!s.pV.isValid(t[0])||"object"!=typeof t[1]&&"string"!=typeof t[1])throw new r.BP("eth_signTypedDataV4",'Invalid input params for "eth_signTypedDataV4" method. See https://docs.metamask.io/wallet/reference/eth_signtypeddata_v4/ for details.',{params:t});if((null==a?void 0:a.wallet)===void 0||await a.getSigner(t[0])===null)throw new r.BP("eth_signTypedDataV4","Provider must be defined with a wallet. Ensure that the provider is defined, connected to the network and has the wallet with the address ".concat(t[0]," into it."),{provider:a});let[n]=t,i;if("string"==typeof t[1])try{let e=JSON.parse(t[1]),a="object"==typeof e&&null!==e&&!Array.isArray(e),n="primaryType"in e&&"domain"in e&&"types"in e&&"message"in e;if(!a||!n)throw new r.BP("eth_signTypedDataV4","Invalid typedData structure",{params:t});i=e}catch(e){throw new r.BP("eth_signTypedData_v4","Invalid JSON string for typed data parameter",{params:t},e)}else i=t[1];if("object"!=typeof i.domain||null===i.domain)throw new r.BP("eth_signTypedDataV4","Invalid typedData structure",{params:t});try{return await (await a.getSigner(n)).signTypedData(i.domain,i.types,i.message,i.primaryType)}catch(a){throw new r.pt("eth_signTypedDataV4",'Method "eth_signTypedDataV4" failed.',{params:(0,r.Gr)(t),url:e.httpClient.baseURL},a)}},t_=async(e,t,a)=>{if(void 0===a)throw new r.pt("eth_subscribe()",'Method "eth_subscribe" failed. Provider is not defined.',{url:e.httpClient.baseURL,params:(0,r.Gr)(t)});if("newHeads"!==t[0]&&"logs"!==t[0])throw new r.BP("eth_subscribe()",'Method "eth_subscribe" failed. Invalid subscription type param.',{url:e.httpClient.baseURL,params:(0,r.Gr)(t)});if(void 0===a.getPollInstance()){let n=await e.blocks.getBestBlockCompressed();if(null!=n)a.subscriptionManager.currentBlockNumber=n.number;else throw new r.vJ("eth_subscribe()",'Method "eth_subscribe" failed. Best block not available.',{url:e.httpClient.baseURL,params:(0,r.Gr)(t)});a.startSubscriptionsPolling()}let n=s._h.random(16).digits;return t.includes("newHeads")&&(a.subscriptionManager.newHeadsSubscription={subscriptionId:n,subscription:{type:"newHeads"}}),t.includes("logs")&&a.subscriptionManager.logSubscriptions.set(n,{type:"logs",options:t[1]}),n},tP=e=>Math.floor(Date.now()/1e3)-e.timestamp<11e3,tB=async e=>{try{let t=await e.blocks.getBestBlockCompressed(),a=await e.blocks.getGenesisBlock(),n=null!==a?s.fo.of(Math.floor((Date.now()-a.timestamp)/1e4)).toString():null;if(null!==t){if(tP(t))return!1;let a=await eW(e);return{currentBlock:eN.formatToRPCStandard(t,a),highestBlock:n,startingBlock:null}}return{currentBlock:null,highestBlock:n,startingBlock:null}}catch(t){throw new r.pt("eth_syncing()",'Method "eth_syncing" failed.',{url:e.httpClient.baseURL,innerError:(0,r.Gr)(t)})}},tk=async(e,t)=>{let a=!1;if(void 0===t)throw new r.pt("eth_unsubscribe()",'Method "eth_unsubscribe" failed. Provider is not defined.',{params:(0,r.Gr)(e)});let n=e[0];return void 0!==t.subscriptionManager.newHeadsSubscription&&n===t.subscriptionManager.newHeadsSubscription.subscriptionId?(t.subscriptionManager.newHeadsSubscription=void 0,a=!0):a=t.subscriptionManager.logSubscriptions.delete(n),t.isThereActiveSubscriptions()||t.stopSubscriptionsPolling(),await Promise.resolve(a)},tI=async e=>{try{let t=await e.blocks.getBestBlockCompressed();if(null===t)throw new r.pt("evm_mine()",'Method "evm_mine" failed. No best block found.',{url:e.httpClient.baseURL});return await U.SyncPoll(()=>e.blocks.getHeadBlock()).waitUntil(e=>e!==t),null}catch(t){throw t instanceof r.pt?t:new r.pt("evm_mine()",'Method "evm_mine" failed.',{url:e.httpClient.baseURL,innerError:(0,r.Gr)(t)})}},tC=async e=>{try{return await e.nodes.isHealthy()}catch(t){throw new r.pt("net_listening()",'Method "net_listening" failed.',{url:e.httpClient.baseURL,innerError:(0,r.Gr)(t)})}},tx=async e=>{try{return(await e.nodes.getNodes()).length}catch(t){throw new r.pt("net_peerCount()",'Method "net_peerCount" failed.',{url:e.httpClient.baseURL,innerError:(0,r.Gr)(t)})}},tS=async e=>await eW(e),tM=async()=>await Promise.resolve({}),tE=async e=>{if(1!==e.length||"string"!=typeof e[0]||!s.pV.isValid(e[0]))throw new r.BP("txpool_contentFrom()",'Invalid input params for "txpool_contentFrom" method. See https://www.quicknode.com/docs/ethereum/txpool_contentFrom for details.',{params:e});return await Promise.resolve({})},tA=async()=>await Promise.resolve({}),tR=async()=>await Promise.resolve({}),tG=async()=>await Promise.resolve("thor"),tN=async e=>{if(1!==e.length||"string"!=typeof e[0]||!s._h.isValid(e[0]))throw new r.BP("web3_sha3","Invalid input params for \"web3_sha3\" method. See 'https://docs.alchemy.com/reference/web3-sha3' for details.",{params:e});return await Promise.resolve(s.gN.of(e[0]).toString())},tF=(e,t)=>({eth_blockNumber:async()=>await e4(e),eth_chainId:async()=>await eW(e),eth_getBalance:async t=>await e7(e,t),eth_getCode:async t=>await tn(e,t),eth_getStorageAt:async t=>await ts(e,t),eth_estimateGas:async t=>await e9(e,t),eth_call:async t=>await e6(e,t),eth_sendRawTransaction:async t=>await tf(e,t),eth_getLogs:async t=>await tr(e,t),eth_getBlockByHash:async t=>await eY(e,t),eth_getBlockByNumber:async t=>await eX(e,t),eth_accounts:async()=>await e3(t),eth_gasPrice:async()=>await e8(e),eth_getTransactionByHash:async t=>await tl(e,t),eth_getTransactionCount:async e=>await tu(e),eth_getTransactionReceipt:async t=>await eQ(e,t),eth_sendTransaction:async a=>await tw(e,a,t),eth_syncing:async()=>await tB(e),net_version:async()=>await tS(e),web3_clientVersion:async()=>await tG(),eth_subscribe:async a=>await t_(e,a,t),eth_unsubscribe:async e=>await tk(e,t),debug_traceTransaction:async t=>await eJ(e,t),debug_traceCall:async t=>await e0(e,t),evm_increaseTime:async()=>await tI(e),evm_mine:async()=>await tI(e),eth_getBlockTransactionCountByHash:async t=>await tt(e,t),eth_getBlockTransactionCountByNumber:async t=>await ta(e,t),eth_getTransactionByBlockHashAndIndex:async t=>await tc(e,t),eth_getTransactionByBlockNumberAndIndex:async t=>await td(e,t),eth_getUncleByBlockHashAndIndex:async e=>await th(e),eth_getUncleByBlockNumberAndIndex:async e=>await tg(e),eth_getUncleCountByBlockHash:async e=>await tp(e),eth_getUncleCountByBlockNumber:async e=>await tm(e),eth_requestAccounts:async()=>await tv(t),net_listening:async()=>await tC(e),net_peerCount:async()=>await tx(e),eth_getBlockReceipts:async t=>await te(e,t),eth_signTransaction:async a=>await tb(e,a,t),web3_sha3:async e=>await tN(e),txpool_inspect:async()=>await tA(),txpool_content:async()=>await tM(),txpool_contentFrom:async e=>await tE(e),txpool_status:async()=>await tR(),debug_traceBlockByHash:async t=>await eZ(e,t),debug_traceBlockByNumber:async t=>await e$(e,t),eth_signTypedData_v4:async a=>await tT(e,a,t),eth_maxPriorityFeePerGas:async t=>await ty(e),eth_feeHistory:async t=>await e5(e,t)}),tD=class extends l.EventEmitter{destroy(){this.thorClient.destroy(),void 0!==this.pollInstance&&(this.pollInstance.stopListen(),this.pollInstance=void 0)}async request(e){if(!Object.values(B).map(e=>e.toString()).includes(e.method))throw new r.mQ("VeChainProvider.request()","Method not found",{code:-32601,message:"Method not found"});let t=tF(this.thorClient,this);if(!(e.method in t))throw new r.wr(e.method,"Method not implemented",{code:-32004,message:"Method not supported"});return await t[e.method](e.params)}startSubscriptionsPolling(){let e=!1;return void 0===this.pollInstance&&(this.pollInstance=U.createEventPoll(async()=>{let e=[],t=await this.getCurrentBlock();if(null!==t){if(void 0!==this.subscriptionManager.newHeadsSubscription&&e.push({method:"eth_subscription",params:{subscription:this.subscriptionManager.newHeadsSubscription.subscriptionId,result:t}}),this.subscriptionManager.logSubscriptions.size>0){let t=await this.getLogsRPC();e.push(...t)}this.subscriptionManager.currentBlockNumber++}return e},5e3).onData(e=>{e.forEach(e=>{this.emit("message",e)})}),this.pollInstance.startListen(),e=!0),e}stopSubscriptionsPolling(){let e=!1;return void 0!==this.pollInstance&&(this.pollInstance.stopListen(),this.pollInstance=void 0,e=!0),e}isThereActiveSubscriptions(){return this.subscriptionManager.logSubscriptions.size>0||void 0!==this.subscriptionManager.newHeadsSubscription}getPollInstance(){return this.pollInstance}async getLogsRPC(){let e=Array.from(this.subscriptionManager.logSubscriptions.entries()).map(async e=>{var t,a;let[n,i]=e,o=s.fo.of(this.subscriptionManager.currentBlockNumber).toString(),r={address:null===(t=i.options)||void 0===t?void 0:t.address,fromBlock:o,toBlock:o,topics:null===(a=i.options)||void 0===a?void 0:a.topics};return{method:"eth_subscription",params:{subscription:n,result:await tr(this.thorClient,[r])}}});return(await Promise.all(e)).filter(e=>e.params.result.length>0)}async getCurrentBlock(){let e=null;if(this.isThereActiveSubscriptions()){let t=await this.thorClient.blocks.getBlockCompressed(this.subscriptionManager.currentBlockNumber);null!=t&&(e=t)}return e}async getSigner(e){var t;return void 0===this.wallet?null:await (null===(t=this.wallet)||void 0===t?void 0:t.getSigner(this,e))}async resolveName(e){return await W.resolveName(this.thorClient,e)}async lookupAddress(e){return await W.lookupAddress(this.thorClient,e)}constructor(e,t,a=!1){super(),this.subscriptionManager={logSubscriptions:new Map,currentBlockNumber:0},this.thorClient=e,this.wallet=t,this.enableDelegation=a}},tL=class extends tD{async send(e,t){return await this.request({method:e,params:t})}async sendAsync(e,t){try{let a=await this.request({method:e.method,params:e.params});t(null,{id:e.id,jsonrpc:"2.0",result:a})}catch(a){t(a,{id:e.id,jsonrpc:"2.0"})}}async request(e){let t=this.rpcConfiguration.ethGetTransactionCountMustReturn0&&"eth_getTransactionCount"===e.method;try{if(this.debug){let t=await this.wallet.getAddresses(),a=await this.wallet.getGasPayer();(0,p.B)("log").log({title:"Sending request - ".concat(e.method),messages:["params: ".concat((0,r.Gr)(e.params)),"accounts: ".concat((0,r.Gr)(t)),"gasPayer: ".concat((0,r.Gr)(a)),"url: ".concat(this.thorClient.httpClient.baseURL)]})}let a=t?"0x0":await super.request({method:e.method,params:e.params});return this.debug&&(0,p.B)("log").log({title:"Get request - ".concat(e.method," result"),messages:["result: ".concat((0,r.Gr)(a))]}),a}catch(t){if(this.debug&&(0,p.B)("error").log(new r.pt(e.method,"Error on request - ".concat(e.method),{args:e})),t instanceof r.Kx)throw t;if(t instanceof r.jK)throw this.buildHardhatErrorFunctionCallback("Error on request ".concat(e.method,": ").concat(t.innerError),t)}}constructor(e,t,a,n=!1,i=!1,o={ethGetTransactionCountMustReturn0:!1}){super(new ev(new _(t)),e,i),this.debug=n,this.rpcConfiguration=o,this.buildHardhatErrorFunctionCallback=a}};let tU=ev.at("https://mainnet.vechain.org"),tO="https://explore.vechain.org";function tH(e){return"".concat(e.slice(0,5),"...").concat(e.slice(-5))}var tV=a(7261),tj=a.n(tV),tq=a(7620);function tW(){let[e,t]=(0,tq.useState)([]),[a,n]=(0,tq.useState)("0xc3bE339D3D20abc1B731B320959A96A08D479583");async function r(e){try{let a=await tU.blocks.getBestBlockCompressed(),n={criteriaSet:[{sender:e},{recipient:e}],order:"desc",range:{unit:"block",from:0,to:a.number}},i=(await tU.logs.filterTransferLogs(n)).map(e=>({from:e.sender,to:e.recipient,amount:e.amount,meta:e.meta}));t(i)}catch(e){t([]),console.log(e)}}return(0,tq.useEffect)(()=>{s.pV.isValid(a)&&r(a)},[a]),(0,i.jsxs)("main",{className:"isolate bg-white px-6 py-24 sm:py-32 lg:px-8",children:[(0,i.jsx)(o.Y,{}),(0,i.jsxs)("div",{className:"my-20 mx-auto max-w-2xl text-center",children:[(0,i.jsx)("p",{className:"my-5 text-lg leading-8 text-gray-600",children:"Insert an address to get the transfer history"}),(0,i.jsx)("input",{type:"text",name:"address","data-testid":"address",onChange:e=>{n(e.target.value)},value:a,className:"block mx-auto w-full sm:max-w-md border-2 border-dark focus:border-purple-500 bg-transparent py-2 px-4 text-lg text-gray-900 placeholder:text-gray-400 focus:ring-0 sm:text-sm sm:leading-6 outline-none rounded-md",placeholder:"0xc3bE339D3D20abc1B731B320959A96A08D479583"})]}),(0,i.jsx)("div",{className:"table-container mx-auto max-w-4xl overflow-x-auto text-center justify-center flex flex-col",children:(0,i.jsxs)("table",{className:"table-auto",children:[(0,i.jsx)("thead",{children:(0,i.jsxs)("tr",{children:[(0,i.jsx)("th",{className:"px-4 py-2",children:"Time"}),(0,i.jsx)("th",{className:"px-4 py-2",children:"From"}),(0,i.jsx)("th",{className:"px-4 py-2",children:"To"}),(0,i.jsx)("th",{className:"px-4 py-2",children:"Amount"}),(0,i.jsx)("th",{className:"px-4 py-2",children:"Transaction Id"})]})}),(0,i.jsx)("tbody",{children:e.map(e=>(0,i.jsxs)("tr",{children:[(0,i.jsx)("td",{className:"px-4 py-2",children:(0,i.jsx)("p",{"data-testid":"timestamp-".concat(e.meta.blockTimestamp),children:new Date(1e3*e.meta.blockTimestamp).toISOString()})}),(0,i.jsx)("td",{className:"px-4 py-2",children:(0,i.jsx)(tj(),{href:"".concat(tO,"/accounts/").concat(e.from),target:"_blank",className:"text-blue-500 hover:underline","data-testid":"transfer-from-".concat(e.from.slice(2,10)),children:(0,i.jsx)("p",{children:tH(e.from)})})}),(0,i.jsx)("td",{className:"px-4 py-2",children:(0,i.jsx)(tj(),{href:"".concat(tO,"/accounts/").concat(e.to),target:"_blank",className:"text-blue-500 hover:underline","data-testid":"transfer-to-".concat(e.to.slice(2,10)),children:tH(e.to)})}),(0,i.jsx)("td",{className:"px-4 py-2",children:(0,i.jsx)("p",{"data-testid":"transfer-amount-".concat(e.amount),children:s.WU.formatEther(s.ie.of(e.amount))})}),(0,i.jsx)("td",{className:"px-4 py-2",children:(0,i.jsx)(tj(),{href:"".concat(tO,"/transactions/").concat(e.meta.txID),target:"_blank",className:"text-blue-500 hover:underline","data-testid":"transaction-id-".concat(e.meta.txID.slice(2,10)),children:tH(e.meta.txID)})})]},e.meta.txID))})]})})]})}}},e=>{var t=t=>e(e.s=t);e.O(0,[342,261,193,827,587,315,358],()=>t(1305)),_N_E=e.O()}]);