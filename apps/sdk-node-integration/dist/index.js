'use strict';var sdkNetwork=require('@vechain/sdk-network');var e=class{thorClient;monitoringPoll;latestTimestamp=0;webhookUrl;constructor(t,o){this.thorClient=sdkNetwork.ThorClient.fromUrl(t),this.webhookUrl=o;}startLogging(t){this.monitoringPoll=sdkNetwork.Poll.createEventPoll(async()=>{try{let o=await this.thorClient.blocks.getBestBlockCompressed(),n={criteriaSet:[{sender:t},{recipient:t}],order:"desc",range:{unit:"block",from:o!=null?o.number:0,to:o!=null?o.number+100:100}},r=(await this.thorClient.logs.filterTransferLogs(n)).filter(s=>s.meta.blockTimestamp>this.latestTimestamp);return r.length>0&&(this.latestTimestamp=r[0].meta.blockTimestamp,this.webhookUrl!=null&&await this.notifyWebhook(r)),r}catch(o){throw console.error("Error while fetching transfer logs:",o),o}},1e3).onStart(()=>{console.log(`Start monitoring account ${t}`);}).onStop(()=>{console.log(`Stop monitoring account ${t}`);}).onData(o=>{o.forEach(n=>{console.log("Transaction details:",n);});}).onError(o=>{console.log("Error:",o);}),this.monitoringPoll.startListen();}stopLogging(){this.monitoringPoll!=null&&this.monitoringPoll.stopListen();}async notifyWebhook(t){try{let o=await fetch(this.webhookUrl,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(t)});if(!o.ok)throw new Error(`HTTP error! status: ${o.status}`);console.log("Webhook notification sent successfully");}catch(o){console.error("Error sending webhook notification:",o);}}};var i=new e("https://testnet.vechain.org/");i.startLogging("0xc3bE339D3D20abc1B731B320959A96A08D479583");setTimeout(()=>{i.stopLogging();},6e4);
//# sourceMappingURL=index.js.map
//# sourceMappingURL=index.js.map